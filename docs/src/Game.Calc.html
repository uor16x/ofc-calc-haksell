<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-unrecognised-pragmas #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# HLINT ignore &quot;Use bimap&quot; #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# HLINT ignore &quot;Use first&quot; #-}</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- | Game calculations and its processing functions</span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Game.Calc</span><span class="hs-special">(</span><span class="annot"><a href="Game.Calc.html#PlayerInput"><span class="hs-identifier">PlayerInput</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Game.Calc.html#LineResult"><span class="hs-identifier">LineResult</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Game.Calc.html#LineType"><span class="hs-identifier">LineType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Game.Calc.html#PlayerCalculations"><span class="hs-identifier">PlayerCalculations</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Game.Calc.html#comparePlayers"><span class="hs-identifier">comparePlayers</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Game.Calc.html#calcGame"><span class="hs-identifier">calcGame</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="CardParts.Cards.html"><span class="hs-identifier">CardParts.Cards</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="CardParts.Cards.html#Card"><span class="hs-identifier">Card</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Game.Combination.html"><span class="hs-identifier">Game.Combination</span></a></span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier">Combination</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>      </span><span class="annot"><a href="Game.Combination.html#CombinationName"><span class="hs-identifier">CombinationName</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>      </span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier">Combination</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Game.Combination.html#RankCombination"><span class="hs-identifier">RankCombination</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>      </span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier">Combination</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="CardParts.Values.html"><span class="hs-identifier">CardParts.Values</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="CardParts.Values.html#Value"><span class="hs-identifier">Value</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="CardParts.Suits.html"><span class="hs-identifier">CardParts.Suits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="CardParts.Suits.html#Suit"><span class="hs-identifier">Suit</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FromJSON</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ToJSON</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">find</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-comment">-- Type for player input values</span><span>
</span><span id="line-20"></span><span id="local-6989586621679089587"><span id="local-6989586621679089588"></span></span><span class="hs-keyword">data</span><span> </span><span id="PlayerInput"><span class="annot"><a href="Game.Calc.html#PlayerInput"><span class="hs-identifier hs-var">PlayerInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PlayerInput"><span class="annot"><a href="Game.Calc.html#PlayerInput"><span class="hs-identifier hs-var">PlayerInput</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-21"></span><span>    </span><span id="username"><span class="annot"><span class="annottext">PlayerInput -&gt; String
</span><a href="Game.Calc.html#username"><span class="hs-identifier hs-var hs-var">username</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span id="board"><span class="annot"><span class="annottext">PlayerInput -&gt; [Combination]
</span><a href="Game.Calc.html#board"><span class="hs-identifier hs-var hs-var">board</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier hs-type">Combination</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span id="scoop"><span class="annot"><span class="annottext">PlayerInput -&gt; Bool
</span><a href="Game.Calc.html#scoop"><span class="hs-identifier hs-var hs-var">scoop</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span id="withFantasy"><span class="annot"><span class="annottext">PlayerInput -&gt; Bool
</span><a href="Game.Calc.html#withFantasy"><span class="hs-identifier hs-var hs-var">withFantasy</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-25"></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679089576"><span id="local-6989586621679089578"><span id="local-6989586621679089580"><span class="annot"><span class="annottext">Int -&gt; PlayerInput -&gt; ShowS
[PlayerInput] -&gt; ShowS
PlayerInput -&gt; String
(Int -&gt; PlayerInput -&gt; ShowS)
-&gt; (PlayerInput -&gt; String)
-&gt; ([PlayerInput] -&gt; ShowS)
-&gt; Show PlayerInput
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PlayerInput] -&gt; ShowS
$cshowList :: [PlayerInput] -&gt; ShowS
show :: PlayerInput -&gt; String
$cshow :: PlayerInput -&gt; String
showsPrec :: Int -&gt; PlayerInput -&gt; ShowS
$cshowsPrec :: Int -&gt; PlayerInput -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. PlayerInput -&gt; Rep PlayerInput x)
-&gt; (forall x. Rep PlayerInput x -&gt; PlayerInput)
-&gt; Generic PlayerInput
forall x. Rep PlayerInput x -&gt; PlayerInput
forall x. PlayerInput -&gt; Rep PlayerInput x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep PlayerInput x -&gt; PlayerInput
$cfrom :: forall x. PlayerInput -&gt; Rep PlayerInput x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679089568"><span id="local-6989586621679089570"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Game.Calc.html#PlayerInput"><span class="hs-identifier hs-type">PlayerInput</span></a></span></span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679089559"><span id="local-6989586621679089561"><span id="local-6989586621679089563"><span id="local-6989586621679089565"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Game.Calc.html#PlayerInput"><span class="hs-identifier hs-type">PlayerInput</span></a></span></span></span></span></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">-- Enum for lines types</span><span>
</span><span id="line-32"></span><span id="local-6989586621679089556"><span id="local-6989586621679089557"></span></span><span class="hs-keyword">data</span><span> </span><span id="LineType"><span class="annot"><a href="Game.Calc.html#LineType"><span class="hs-identifier hs-var">LineType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Top"><span class="annot"><a href="Game.Calc.html#Top"><span class="hs-identifier hs-var">Top</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Middle"><span class="annot"><a href="Game.Calc.html#Middle"><span class="hs-identifier hs-var">Middle</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Bottom"><span class="annot"><a href="Game.Calc.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679089547"><span id="local-6989586621679089549"><span id="local-6989586621679089551"><span class="annot"><span class="annottext">Int -&gt; LineType -&gt; ShowS
[LineType] -&gt; ShowS
LineType -&gt; String
(Int -&gt; LineType -&gt; ShowS)
-&gt; (LineType -&gt; String) -&gt; ([LineType] -&gt; ShowS) -&gt; Show LineType
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [LineType] -&gt; ShowS
$cshowList :: [LineType] -&gt; ShowS
show :: LineType -&gt; String
$cshow :: LineType -&gt; String
showsPrec :: Int -&gt; LineType -&gt; ShowS
$cshowsPrec :: Int -&gt; LineType -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. LineType -&gt; Rep LineType x)
-&gt; (forall x. Rep LineType x -&gt; LineType) -&gt; Generic LineType
forall x. Rep LineType x -&gt; LineType
forall x. LineType -&gt; Rep LineType x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep LineType x -&gt; LineType
$cfrom :: forall x. LineType -&gt; Rep LineType x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679089541"><span id="local-6989586621679089543"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Game.Calc.html#LineType"><span class="hs-identifier hs-type">LineType</span></a></span></span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679089533"><span id="local-6989586621679089535"><span id="local-6989586621679089537"><span id="local-6989586621679089539"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Game.Calc.html#LineType"><span class="hs-identifier hs-type">LineType</span></a></span></span></span></span></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">-- Utility type to represent a pair of values</span><span>
</span><span id="line-39"></span><span class="hs-keyword">type</span><span> </span><span id="IntPair"><span class="annot"><a href="Game.Calc.html#IntPair"><span class="hs-identifier hs-var">IntPair</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">{- | Data container for lines comparison result.

First tuple element - list of strings.
Contains usernames of users, which are being compared.

Second tuple element - int.
Represents summ of combination points for first player.
No need to store the value for second user, as it would be the same, just negated (* -1).

Third tuple element - int.
Represents summ of bonuses for first player.
No need to store the value for second user, as it would be the same, just negated (* -1).

Fourth tuple element - list of (int, int) tuples.
This is used mainly for debug and contains each line comparison result.

-}</span><span>
</span><span id="line-58"></span><span class="hs-keyword">type</span><span> </span><span id="LineCompareResult"><span class="annot"><a href="Game.Calc.html#LineCompareResult"><span class="hs-identifier hs-var">LineCompareResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.Calc.html#IntPair"><span class="hs-identifier hs-type">IntPair</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">{- | Data container for line result for the user.

Contains data about type of line (position - top/middle/bottom),
about points for the combination,
total values for combo/bonus points after comparison with others.

-}</span><span>
</span><span id="line-68"></span><span id="local-6989586621679089530"><span id="local-6989586621679089531"></span></span><span class="hs-keyword">data</span><span> </span><span id="LineResult"><span class="annot"><a href="Game.Calc.html#LineResult"><span class="hs-identifier hs-var">LineResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LineResult"><span class="annot"><a href="Game.Calc.html#LineResult"><span class="hs-identifier hs-var">LineResult</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-69"></span><span>    </span><span id="lineType"><span class="annot"><span class="annottext">LineResult -&gt; LineType
</span><a href="Game.Calc.html#lineType"><span class="hs-identifier hs-var hs-var">lineType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.Calc.html#LineType"><span class="hs-identifier hs-type">LineType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>    </span><span id="combination"><span class="annot"><span class="annottext">LineResult -&gt; Maybe Combination
</span><a href="Game.Calc.html#combination"><span class="hs-identifier hs-var hs-var">combination</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier hs-type">Combination</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>    </span><span id="points"><span class="annot"><span class="annottext">LineResult -&gt; Int
</span><a href="Game.Calc.html#points"><span class="hs-identifier hs-var hs-var">points</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>    </span><span id="totalCombination"><span class="annot"><span class="annottext">LineResult -&gt; Int
</span><a href="Game.Calc.html#totalCombination"><span class="hs-identifier hs-var hs-var">totalCombination</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>    </span><span id="totalBonus"><span class="annot"><span class="annottext">LineResult -&gt; Int
</span><a href="Game.Calc.html#totalBonus"><span class="hs-identifier hs-var hs-var">totalBonus</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-74"></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679089518"><span id="local-6989586621679089520"><span id="local-6989586621679089522"><span class="annot"><span class="annottext">Int -&gt; LineResult -&gt; ShowS
[LineResult] -&gt; ShowS
LineResult -&gt; String
(Int -&gt; LineResult -&gt; ShowS)
-&gt; (LineResult -&gt; String)
-&gt; ([LineResult] -&gt; ShowS)
-&gt; Show LineResult
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [LineResult] -&gt; ShowS
$cshowList :: [LineResult] -&gt; ShowS
show :: LineResult -&gt; String
$cshow :: LineResult -&gt; String
showsPrec :: Int -&gt; LineResult -&gt; ShowS
$cshowsPrec :: Int -&gt; LineResult -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. LineResult -&gt; Rep LineResult x)
-&gt; (forall x. Rep LineResult x -&gt; LineResult) -&gt; Generic LineResult
forall x. Rep LineResult x -&gt; LineResult
forall x. LineResult -&gt; Rep LineResult x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep LineResult x -&gt; LineResult
$cfrom :: forall x. LineResult -&gt; Rep LineResult x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679089512"><span id="local-6989586621679089514"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Game.Calc.html#LineResult"><span class="hs-identifier hs-type">LineResult</span></a></span></span></span><span>
</span><span id="line-77"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679089504"><span id="local-6989586621679089506"><span id="local-6989586621679089508"><span id="local-6989586621679089510"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Game.Calc.html#LineResult"><span class="hs-identifier hs-type">LineResult</span></a></span></span></span></span></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">{- | Container for result of calculations for each player.

Contains data about given player input,
description of each line in form of 'LineResult',
some utility bool values, such as 'isScoop', 'isNextFantasy'.
Also has total sum of points for user after comparison.
And a debug detailed version of the total (totalDetailed field).

-}</span><span>
</span><span id="line-89"></span><span id="local-6989586621679089502"><span id="local-6989586621679089503"></span></span><span class="hs-keyword">data</span><span> </span><span id="PlayerCalculations"><span class="annot"><a href="Game.Calc.html#PlayerCalculations"><span class="hs-identifier hs-var">PlayerCalculations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PlayerCalculations"><span class="annot"><a href="Game.Calc.html#PlayerCalculations"><span class="hs-identifier hs-var">PlayerCalculations</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-90"></span><span>    </span><span id="player"><span class="annot"><span class="annottext">PlayerCalculations -&gt; PlayerInput
</span><a href="Game.Calc.html#player"><span class="hs-identifier hs-var hs-var">player</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.Calc.html#PlayerInput"><span class="hs-identifier hs-type">PlayerInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-91"></span><span>    </span><span id="top"><span class="annot"><span class="annottext">PlayerCalculations -&gt; LineResult
</span><a href="Game.Calc.html#top"><span class="hs-identifier hs-var hs-var">top</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.Calc.html#LineResult"><span class="hs-identifier hs-type">LineResult</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>    </span><span id="middle"><span class="annot"><span class="annottext">PlayerCalculations -&gt; LineResult
</span><a href="Game.Calc.html#middle"><span class="hs-identifier hs-var hs-var">middle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.Calc.html#LineResult"><span class="hs-identifier hs-type">LineResult</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-93"></span><span>    </span><span id="bottom"><span class="annot"><span class="annottext">PlayerCalculations -&gt; LineResult
</span><a href="Game.Calc.html#bottom"><span class="hs-identifier hs-var hs-var">bottom</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.Calc.html#LineResult"><span class="hs-identifier hs-type">LineResult</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-94"></span><span>    </span><span id="isScoop"><span class="annot"><span class="annottext">PlayerCalculations -&gt; Bool
</span><a href="Game.Calc.html#isScoop"><span class="hs-identifier hs-var hs-var">isScoop</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span>    </span><span id="isNextFantasy"><span class="annot"><span class="annottext">PlayerCalculations -&gt; Bool
</span><a href="Game.Calc.html#isNextFantasy"><span class="hs-identifier hs-var hs-var">isNextFantasy</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span>
</span><span id="line-96"></span><span>    </span><span id="totalDetailed"><span class="annot"><span class="annottext">PlayerCalculations -&gt; (String, [LineCompareResult])
</span><a href="Game.Calc.html#totalDetailed"><span class="hs-identifier hs-var hs-var">totalDetailed</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.Calc.html#LineCompareResult"><span class="hs-identifier hs-type">LineCompareResult</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span>    </span><span id="total"><span class="annot"><span class="annottext">PlayerCalculations -&gt; Int
</span><a href="Game.Calc.html#total"><span class="hs-identifier hs-var hs-var">total</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-98"></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. PlayerCalculations -&gt; Rep PlayerCalculations x)
-&gt; (forall x. Rep PlayerCalculations x -&gt; PlayerCalculations)
-&gt; Generic PlayerCalculations
forall x. Rep PlayerCalculations x -&gt; PlayerCalculations
forall x. PlayerCalculations -&gt; Rep PlayerCalculations x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep PlayerCalculations x -&gt; PlayerCalculations
$cfrom :: forall x. PlayerCalculations -&gt; Rep PlayerCalculations x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679089487"><span id="local-6989586621679089489"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Game.Calc.html#PlayerCalculations"><span class="hs-identifier hs-type">PlayerCalculations</span></a></span></span></span><span>
</span><span id="line-101"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679089479"><span id="local-6989586621679089481"><span id="local-6989586621679089483"><span id="local-6989586621679089485"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Game.Calc.html#PlayerCalculations"><span class="hs-identifier hs-type">PlayerCalculations</span></a></span></span></span></span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">{- | Main function for game calculation.

Takes a list of 'PlayerInput;, which length should be 3.
Return a list of 'PlayerCalculations'.

First of all, function receives all players comparison using 'collectLinesResults'.
Then it checks for input conditions:
length of input and length of comparison results should be equal and should equal 3.

Then for each of player input function creates 'PlayerCalculations' record.
-}</span><span>
</span><span id="line-115"></span><span class="annot"><a href="Game.Calc.html#calcGame"><span class="hs-identifier hs-type">calcGame</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.Calc.html#PlayerInput"><span class="hs-identifier hs-type">PlayerInput</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.Calc.html#PlayerCalculations"><span class="hs-identifier hs-type">PlayerCalculations</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-116"></span><span id="calcGame"><span class="annot"><span class="annottext">calcGame :: [PlayerInput] -&gt; [PlayerCalculations]
</span><a href="Game.Calc.html#calcGame"><span class="hs-identifier hs-var hs-var">calcGame</span></a></span></span><span> </span><span id="local-6989586621679089478"><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089478"><span class="hs-identifier hs-var">playerInputs</span></a></span></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[PlayerInput] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089478"><span class="hs-identifier hs-var">playerInputs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [PlayerCalculations]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid number of players&quot;</span></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[(String, [LineCompareResult])] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(String, [LineCompareResult])]
</span><a href="#local-6989586621679089474"><span class="hs-identifier hs-var">linesResults</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [PlayerCalculations]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid number of linesResults&quot;</span></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; PlayerCalculations) -&gt; [Int] -&gt; [PlayerCalculations]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; PlayerCalculations
</span><a href="#local-6989586621679089473"><span class="hs-identifier hs-var">mapLinesResults</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">]</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-comment">-- Value which holds result of lines comparison for all inputs</span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><a href="#local-6989586621679089474"><span class="hs-identifier hs-type">linesResults</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.Calc.html#LineCompareResult"><span class="hs-identifier hs-type">LineCompareResult</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-123"></span><span>    </span><span id="local-6989586621679089474"><span class="annot"><span class="annottext">linesResults :: [(String, [LineCompareResult])]
</span><a href="#local-6989586621679089474"><span class="hs-identifier hs-var hs-var">linesResults</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LineCompareResult]
-&gt; [PlayerInput]
-&gt; [PlayerInput]
-&gt; [(String, [LineCompareResult])]
</span><a href="Game.Calc.html#collectLinesResults"><span class="hs-identifier hs-var">collectLinesResults</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089478"><span class="hs-identifier hs-var">playerInputs</span></a></span><span> </span><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089478"><span class="hs-identifier hs-var">playerInputs</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-comment">{-| Mapping function for each given 'PlayerInput'.
        Given int argument - index of player.
    -}</span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><a href="#local-6989586621679089473"><span class="hs-identifier hs-type">mapLinesResults</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Game.Calc.html#PlayerCalculations"><span class="hs-identifier hs-type">PlayerCalculations</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span id="local-6989586621679089473"><span class="annot"><span class="annottext">mapLinesResults :: Int -&gt; PlayerCalculations
</span><a href="#local-6989586621679089473"><span class="hs-identifier hs-var hs-var">mapLinesResults</span></a></span></span><span> </span><span id="local-6989586621679089471"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089471"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlayerCalculations :: PlayerInput
-&gt; LineResult
-&gt; LineResult
-&gt; LineResult
-&gt; Bool
-&gt; Bool
-&gt; (String, [LineCompareResult])
-&gt; Int
-&gt; PlayerCalculations
</span><a href="Game.Calc.html#PlayerCalculations"><span class="hs-identifier hs-type">PlayerCalculations</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-130"></span><span>      </span><span class="hs-comment">-- player is simply copy of input, on which calc is based</span><span>
</span><span id="line-131"></span><span>      </span><span class="annot"><span class="annottext">player :: PlayerInput
</span><a href="Game.Calc.html#player"><span class="hs-identifier hs-var">player</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089478"><span class="hs-identifier hs-var">playerInputs</span></a></span><span> </span><span class="annot"><span class="annottext">[PlayerInput] -&gt; Int -&gt; PlayerInput
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089471"><span class="hs-identifier hs-var">index</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span>      </span><span class="hs-comment">-- isScoop is bool value to define whether the scoop for the user occurred</span><span>
</span><span id="line-134"></span><span>      </span><span class="annot"><span class="annottext">isScoop :: Bool
</span><a href="Game.Calc.html#isScoop"><span class="hs-identifier hs-var">isScoop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlayerInput -&gt; Bool
</span><a href="Game.Calc.html#scoop"><span class="hs-identifier hs-var hs-var">scoop</span></a></span><span> </span><span class="annot"><span class="annottext">(PlayerInput -&gt; Bool) -&gt; PlayerInput -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089478"><span class="hs-identifier hs-var">playerInputs</span></a></span><span> </span><span class="annot"><span class="annottext">[PlayerInput] -&gt; Int -&gt; PlayerInput
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089471"><span class="hs-identifier hs-var">index</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span>      </span><span class="hs-comment">-- isNextFantasy is bool value to determine thether the fantasy</span><span>
</span><span id="line-137"></span><span>      </span><span class="annot"><span class="annottext">isNextFantasy :: Bool
</span><a href="Game.Calc.html#isNextFantasy"><span class="hs-identifier hs-var">isNextFantasy</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlayerInput -&gt; Bool
</span><a href="Game.Calc.html#scoop"><span class="hs-identifier hs-var hs-var">scoop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089478"><span class="hs-identifier hs-var">playerInputs</span></a></span><span> </span><span class="annot"><span class="annottext">[PlayerInput] -&gt; Int -&gt; PlayerInput
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089471"><span class="hs-identifier hs-var">index</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-comment">-- scoop should not occur for fantasy to be true</span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; [Combination] -&gt; Bool
</span><a href="#local-6989586621679089467"><span class="hs-identifier hs-var">nextIsFantasy</span></a></span><span> </span><span class="hs-comment">-- call of function which calculates whether next hand is fantasy</span><span>
</span><span id="line-140"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlayerInput -&gt; Bool
</span><a href="Game.Calc.html#withFantasy"><span class="hs-identifier hs-var hs-var">withFantasy</span></a></span><span> </span><span class="annot"><span class="annottext">(PlayerInput -&gt; Bool) -&gt; PlayerInput -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089478"><span class="hs-identifier hs-var">playerInputs</span></a></span><span> </span><span class="annot"><span class="annottext">[PlayerInput] -&gt; Int -&gt; PlayerInput
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089471"><span class="hs-identifier hs-var">index</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- withFantasy getter to find out whether fantasy is on currently</span><span>
</span><span id="line-141"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlayerInput -&gt; [Combination]
</span><a href="Game.Calc.html#board"><span class="hs-identifier hs-var hs-var">board</span></a></span><span> </span><span class="annot"><span class="annottext">(PlayerInput -&gt; [Combination]) -&gt; PlayerInput -&gt; [Combination]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089478"><span class="hs-identifier hs-var">playerInputs</span></a></span><span> </span><span class="annot"><span class="annottext">[PlayerInput] -&gt; Int -&gt; PlayerInput
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089471"><span class="hs-identifier hs-var">index</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span>      </span><span class="hs-comment">-- top line data</span><span>
</span><span id="line-144"></span><span>      </span><span class="annot"><span class="annottext">top :: LineResult
</span><a href="Game.Calc.html#top"><span class="hs-identifier hs-var">top</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LineResult :: LineType -&gt; Maybe Combination -&gt; Int -&gt; Int -&gt; Int -&gt; LineResult
</span><a href="Game.Calc.html#LineResult"><span class="hs-identifier hs-type">LineResult</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><span class="annottext">combination :: Maybe Combination
</span><a href="Game.Calc.html#combination"><span class="hs-identifier hs-var">combination</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlayerInput -&gt; Int -&gt; Maybe Combination
</span><a href="#local-6989586621679089466"><span class="hs-identifier hs-var">combinationByIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089478"><span class="hs-identifier hs-var">playerInputs</span></a></span><span> </span><span class="annot"><span class="annottext">[PlayerInput] -&gt; Int -&gt; PlayerInput
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089471"><span class="hs-identifier hs-var">index</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- top line has index 0,</span><span>
</span><span id="line-146"></span><span>        </span><span class="annot"><span class="annottext">lineType :: LineType
</span><a href="Game.Calc.html#lineType"><span class="hs-identifier hs-var">lineType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Game.Calc.html#Top"><span class="hs-identifier hs-var">Top</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-147"></span><span>        </span><span class="annot"><span class="annottext">points :: Int
</span><a href="Game.Calc.html#points"><span class="hs-identifier hs-var">points</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LineType -&gt; Maybe Combination -&gt; Int
</span><a href="Game.Calc.html#pointsCalc"><span class="hs-identifier hs-var">pointsCalc</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Game.Calc.html#Top"><span class="hs-identifier hs-var">Top</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlayerInput -&gt; Int -&gt; Maybe Combination
</span><a href="#local-6989586621679089466"><span class="hs-identifier hs-var">combinationByIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089478"><span class="hs-identifier hs-var">playerInputs</span></a></span><span> </span><span class="annot"><span class="annottext">[PlayerInput] -&gt; Int -&gt; PlayerInput
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089471"><span class="hs-identifier hs-var">index</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-148"></span><span>        </span><span class="annot"><span class="annottext">totalCombination :: Int
</span><a href="Game.Calc.html#totalCombination"><span class="hs-identifier hs-var">totalCombination</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Int) -&gt; (Int, Int) -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int, Int)
</span><a href="#local-6989586621679089464"><span class="hs-identifier hs-var">getLinePoints</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089471"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><span class="annottext">totalBonus :: Int
</span><a href="Game.Calc.html#totalBonus"><span class="hs-identifier hs-var">totalBonus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Int) -&gt; (Int, Int) -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int, Int)
</span><a href="#local-6989586621679089464"><span class="hs-identifier hs-var">getLinePoints</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089471"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-150"></span><span>      </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span>      </span><span class="hs-comment">-- middle line data</span><span>
</span><span id="line-153"></span><span>      </span><span class="annot"><span class="annottext">middle :: LineResult
</span><a href="Game.Calc.html#middle"><span class="hs-identifier hs-var">middle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LineResult :: LineType -&gt; Maybe Combination -&gt; Int -&gt; Int -&gt; Int -&gt; LineResult
</span><a href="Game.Calc.html#LineResult"><span class="hs-identifier hs-type">LineResult</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><span class="annottext">combination :: Maybe Combination
</span><a href="Game.Calc.html#combination"><span class="hs-identifier hs-var">combination</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlayerInput -&gt; Int -&gt; Maybe Combination
</span><a href="#local-6989586621679089466"><span class="hs-identifier hs-var">combinationByIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089478"><span class="hs-identifier hs-var">playerInputs</span></a></span><span> </span><span class="annot"><span class="annottext">[PlayerInput] -&gt; Int -&gt; PlayerInput
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089471"><span class="hs-identifier hs-var">index</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- middle line has index 1,</span><span>
</span><span id="line-155"></span><span>        </span><span class="annot"><span class="annottext">lineType :: LineType
</span><a href="Game.Calc.html#lineType"><span class="hs-identifier hs-var">lineType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Game.Calc.html#Middle"><span class="hs-identifier hs-var">Middle</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><span class="annottext">points :: Int
</span><a href="Game.Calc.html#points"><span class="hs-identifier hs-var">points</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LineType -&gt; Maybe Combination -&gt; Int
</span><a href="Game.Calc.html#pointsCalc"><span class="hs-identifier hs-var">pointsCalc</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Game.Calc.html#Middle"><span class="hs-identifier hs-var">Middle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlayerInput -&gt; Int -&gt; Maybe Combination
</span><a href="#local-6989586621679089466"><span class="hs-identifier hs-var">combinationByIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089478"><span class="hs-identifier hs-var">playerInputs</span></a></span><span> </span><span class="annot"><span class="annottext">[PlayerInput] -&gt; Int -&gt; PlayerInput
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089471"><span class="hs-identifier hs-var">index</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-157"></span><span>        </span><span class="annot"><span class="annottext">totalCombination :: Int
</span><a href="Game.Calc.html#totalCombination"><span class="hs-identifier hs-var">totalCombination</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Int) -&gt; (Int, Int) -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int, Int)
</span><a href="#local-6989586621679089464"><span class="hs-identifier hs-var">getLinePoints</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089471"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><span class="annottext">totalBonus :: Int
</span><a href="Game.Calc.html#totalBonus"><span class="hs-identifier hs-var">totalBonus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Int) -&gt; (Int, Int) -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int, Int)
</span><a href="#local-6989586621679089464"><span class="hs-identifier hs-var">getLinePoints</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089471"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-159"></span><span>      </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>      </span><span class="hs-comment">-- bottom line data</span><span>
</span><span id="line-162"></span><span>      </span><span class="annot"><span class="annottext">bottom :: LineResult
</span><a href="Game.Calc.html#bottom"><span class="hs-identifier hs-var">bottom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LineResult :: LineType -&gt; Maybe Combination -&gt; Int -&gt; Int -&gt; Int -&gt; LineResult
</span><a href="Game.Calc.html#LineResult"><span class="hs-identifier hs-type">LineResult</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-163"></span><span>        </span><span class="annot"><span class="annottext">combination :: Maybe Combination
</span><a href="Game.Calc.html#combination"><span class="hs-identifier hs-var">combination</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlayerInput -&gt; Int -&gt; Maybe Combination
</span><a href="#local-6989586621679089466"><span class="hs-identifier hs-var">combinationByIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089478"><span class="hs-identifier hs-var">playerInputs</span></a></span><span> </span><span class="annot"><span class="annottext">[PlayerInput] -&gt; Int -&gt; PlayerInput
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089471"><span class="hs-identifier hs-var">index</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- bottom line has index 2,</span><span>
</span><span id="line-164"></span><span>        </span><span class="annot"><span class="annottext">lineType :: LineType
</span><a href="Game.Calc.html#lineType"><span class="hs-identifier hs-var">lineType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Game.Calc.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-165"></span><span>        </span><span class="annot"><span class="annottext">points :: Int
</span><a href="Game.Calc.html#points"><span class="hs-identifier hs-var">points</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LineType -&gt; Maybe Combination -&gt; Int
</span><a href="Game.Calc.html#pointsCalc"><span class="hs-identifier hs-var">pointsCalc</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Game.Calc.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlayerInput -&gt; Int -&gt; Maybe Combination
</span><a href="#local-6989586621679089466"><span class="hs-identifier hs-var">combinationByIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089478"><span class="hs-identifier hs-var">playerInputs</span></a></span><span> </span><span class="annot"><span class="annottext">[PlayerInput] -&gt; Int -&gt; PlayerInput
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089471"><span class="hs-identifier hs-var">index</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-166"></span><span>        </span><span class="annot"><span class="annottext">totalCombination :: Int
</span><a href="Game.Calc.html#totalCombination"><span class="hs-identifier hs-var">totalCombination</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Int) -&gt; (Int, Int) -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int, Int)
</span><a href="#local-6989586621679089464"><span class="hs-identifier hs-var">getLinePoints</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089471"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span>
</span><span id="line-167"></span><span>        </span><span class="annot"><span class="annottext">totalBonus :: Int
</span><a href="Game.Calc.html#totalBonus"><span class="hs-identifier hs-var">totalBonus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Int) -&gt; (Int, Int) -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int, Int)
</span><a href="#local-6989586621679089464"><span class="hs-identifier hs-var">getLinePoints</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089471"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-168"></span><span>      </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span>      </span><span class="hs-comment">-- debug value with detailed calc steps for total points</span><span>
</span><span id="line-171"></span><span>      </span><span class="annot"><span class="annottext">totalDetailed :: (String, [LineCompareResult])
</span><a href="Game.Calc.html#totalDetailed"><span class="hs-identifier hs-var">totalDetailed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(String, [LineCompareResult])]
</span><a href="#local-6989586621679089474"><span class="hs-identifier hs-var">linesResults</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [LineCompareResult])]
-&gt; Int -&gt; (String, [LineCompareResult])
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089471"><span class="hs-identifier hs-var">index</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span>      </span><span class="hs-comment">-- summ of all related to player totals in one number</span><span>
</span><span id="line-174"></span><span>      </span><span class="annot"><span class="annottext">total :: Int
</span><a href="Game.Calc.html#total"><span class="hs-identifier hs-var">total</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String, [LineCompareResult]) -&gt; Int
</span><a href="#local-6989586621679089463"><span class="hs-identifier hs-var">totalPoints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, [LineCompareResult])]
</span><a href="#local-6989586621679089474"><span class="hs-identifier hs-var">linesResults</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [LineCompareResult])]
-&gt; Int -&gt; (String, [LineCompareResult])
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089471"><span class="hs-identifier hs-var">index</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-comment">-- simple getter for combination by index of the board</span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><a href="#local-6989586621679089466"><span class="hs-identifier hs-type">combinationByIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.Calc.html#PlayerInput"><span class="hs-identifier hs-type">PlayerInput</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier hs-type">Combination</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679089466"><span class="annot"><span class="annottext">combinationByIndex :: PlayerInput -&gt; Int -&gt; Maybe Combination
</span><a href="#local-6989586621679089466"><span class="hs-identifier hs-var hs-var">combinationByIndex</span></a></span></span><span> </span><span id="local-6989586621679089462"><span class="annot"><span class="annottext">PlayerInput
</span><a href="#local-6989586621679089462"><span class="hs-identifier hs-var">playerInput</span></a></span></span><span> </span><span id="local-6989586621679089461"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089461"><span class="hs-identifier hs-var">index</span></a></span></span><span>
</span><span id="line-180"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PlayerInput -&gt; Bool
</span><a href="Game.Calc.html#scoop"><span class="hs-identifier hs-var hs-var">scoop</span></a></span><span> </span><span class="annot"><span class="annottext">PlayerInput
</span><a href="#local-6989586621679089462"><span class="hs-identifier hs-var">playerInput</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Combination
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-181"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Maybe Combination
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Combination -&gt; Maybe Combination)
-&gt; Combination -&gt; Maybe Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlayerInput -&gt; [Combination]
</span><a href="Game.Calc.html#board"><span class="hs-identifier hs-var hs-var">board</span></a></span><span> </span><span class="annot"><span class="annottext">PlayerInput
</span><a href="#local-6989586621679089462"><span class="hs-identifier hs-var">playerInput</span></a></span><span> </span><span class="annot"><span class="annottext">[Combination] -&gt; Int -&gt; Combination
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089461"><span class="hs-identifier hs-var">index</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-comment">-- simpe function to summ combination points of line comparison with its bonus points</span><span>
</span><span id="line-184"></span><span>    </span><span class="annot"><a href="#local-6989586621679089460"><span class="hs-identifier hs-type">getTotal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.Calc.html#LineCompareResult"><span class="hs-identifier hs-type">LineCompareResult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-185"></span><span>    </span><span id="local-6989586621679089460"><span class="annot"><span class="annottext">getTotal :: LineCompareResult -&gt; Int
</span><a href="#local-6989586621679089460"><span class="hs-identifier hs-var hs-var">getTotal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679089459"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089459"><span class="hs-identifier hs-var">combo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679089458"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089458"><span class="hs-identifier hs-var">bonus</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Int, Int)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089459"><span class="hs-identifier hs-var">combo</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089458"><span class="hs-identifier hs-var">bonus</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-comment">-- function to summ all temp results into one total number</span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><a href="#local-6989586621679089463"><span class="hs-identifier hs-type">totalPoints</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.Calc.html#LineCompareResult"><span class="hs-identifier hs-type">LineCompareResult</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621679089463"><span class="annot"><span class="annottext">totalPoints :: (String, [LineCompareResult]) -&gt; Int
</span><a href="#local-6989586621679089463"><span class="hs-identifier hs-var hs-var">totalPoints</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679089456"><span class="annot"><span class="annottext">[LineCompareResult]
</span><a href="#local-6989586621679089456"><span class="hs-identifier hs-var">compareResults</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; LineCompareResult -&gt; Int)
-&gt; Int -&gt; [LineCompareResult] -&gt; Int
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679089454"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089454"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679089453"><span class="annot"><span class="annottext">LineCompareResult
</span><a href="#local-6989586621679089453"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089454"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">LineCompareResult -&gt; Int
</span><a href="#local-6989586621679089460"><span class="hs-identifier hs-var">getTotal</span></a></span><span> </span><span class="annot"><span class="annottext">LineCompareResult
</span><a href="#local-6989586621679089453"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[LineCompareResult]
</span><a href="#local-6989586621679089456"><span class="hs-identifier hs-var">compareResults</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-comment">-- function to determine whether the next hand is fantasy</span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><a href="#local-6989586621679089467"><span class="hs-identifier hs-type">nextIsFantasy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier hs-type">Combination</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621679089467"><span class="annot"><span class="annottext">nextIsFantasy :: Bool -&gt; [Combination] -&gt; Bool
</span><a href="#local-6989586621679089467"><span class="hs-identifier hs-var hs-var">nextIsFantasy</span></a></span></span><span> </span><span id="local-6989586621679089452"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089452"><span class="hs-identifier hs-var">withFantasy</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><a href="#local-6989586621679089467"><span class="hs-identifier hs-var">nextIsFantasy</span></a></span><span> </span><span id="local-6989586621679089451"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089451"><span class="hs-identifier hs-var">withFantasy</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679089450"><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089450"><span class="hs-identifier hs-var">top</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679089449"><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089449"><span class="hs-identifier hs-var">middle</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679089448"><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089448"><span class="hs-identifier hs-var">bottom</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Combination]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089451"><span class="hs-identifier hs-var">withFantasy</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-196"></span><span>        </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089450"><span class="hs-identifier hs-var">top</span></a></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Combination -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; Card -&gt; Combination
</span><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-var">RankCombination</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName
</span><a href="Game.Combination.html#Set"><span class="hs-identifier hs-var">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Suit -&gt; Card
</span><a href="CardParts.Cards.html#Card"><span class="hs-identifier hs-var">Card</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="CardParts.Values.html#Two"><span class="hs-identifier hs-var">Two</span></a></span><span> </span><span class="annot"><span class="annottext">Suit
</span><a href="CardParts.Suits.html#Hearts"><span class="hs-identifier hs-var">Hearts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089449"><span class="hs-identifier hs-var">middle</span></a></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Combination -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; Card -&gt; Card -&gt; Combination
</span><a href="Game.Combination.html#PartCombination"><span class="hs-identifier hs-var">PartCombination</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName
</span><a href="Game.Combination.html#FullHouse"><span class="hs-identifier hs-var">FullHouse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Suit -&gt; Card
</span><a href="CardParts.Cards.html#Card"><span class="hs-identifier hs-var">Card</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="CardParts.Values.html#Two"><span class="hs-identifier hs-var">Two</span></a></span><span> </span><span class="annot"><span class="annottext">Suit
</span><a href="CardParts.Suits.html#Hearts"><span class="hs-identifier hs-var">Hearts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Suit -&gt; Card
</span><a href="CardParts.Cards.html#Card"><span class="hs-identifier hs-var">Card</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="CardParts.Values.html#Three"><span class="hs-identifier hs-var">Three</span></a></span><span> </span><span class="annot"><span class="annottext">Suit
</span><a href="CardParts.Suits.html#Hearts"><span class="hs-identifier hs-var">Hearts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089448"><span class="hs-identifier hs-var">bottom</span></a></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Combination -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; Card -&gt; Combination
</span><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-var">RankCombination</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName
</span><a href="Game.Combination.html#FourOfAKind"><span class="hs-identifier hs-var">FourOfAKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Suit -&gt; Card
</span><a href="CardParts.Cards.html#Card"><span class="hs-identifier hs-var">Card</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="CardParts.Values.html#Two"><span class="hs-identifier hs-var">Two</span></a></span><span> </span><span class="annot"><span class="annottext">Suit
</span><a href="CardParts.Suits.html#Hearts"><span class="hs-identifier hs-var">Hearts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089450"><span class="hs-identifier hs-var">top</span></a></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Combination -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; Card -&gt; Combination
</span><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-var">RankCombination</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName
</span><a href="Game.Combination.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Suit -&gt; Card
</span><a href="CardParts.Cards.html#Card"><span class="hs-identifier hs-var">Card</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="CardParts.Values.html#Queen"><span class="hs-identifier hs-var">Queen</span></a></span><span> </span><span class="annot"><span class="annottext">Suit
</span><a href="CardParts.Suits.html#Hearts"><span class="hs-identifier hs-var">Hearts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089449"><span class="hs-identifier hs-var">middle</span></a></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Combination -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; Card -&gt; Card -&gt; Combination
</span><a href="Game.Combination.html#PartCombination"><span class="hs-identifier hs-var">PartCombination</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName
</span><a href="Game.Combination.html#FullHouse"><span class="hs-identifier hs-var">FullHouse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Suit -&gt; Card
</span><a href="CardParts.Cards.html#Card"><span class="hs-identifier hs-var">Card</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="CardParts.Values.html#Two"><span class="hs-identifier hs-var">Two</span></a></span><span> </span><span class="annot"><span class="annottext">Suit
</span><a href="CardParts.Suits.html#Hearts"><span class="hs-identifier hs-var">Hearts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Suit -&gt; Card
</span><a href="CardParts.Cards.html#Card"><span class="hs-identifier hs-var">Card</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="CardParts.Values.html#Three"><span class="hs-identifier hs-var">Three</span></a></span><span> </span><span class="annot"><span class="annottext">Suit
</span><a href="CardParts.Suits.html#Hearts"><span class="hs-identifier hs-var">Hearts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089448"><span class="hs-identifier hs-var">bottom</span></a></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Combination -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; Card -&gt; Combination
</span><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-var">RankCombination</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName
</span><a href="Game.Combination.html#StraightFlush"><span class="hs-identifier hs-var">StraightFlush</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Suit -&gt; Card
</span><a href="CardParts.Cards.html#Card"><span class="hs-identifier hs-var">Card</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="CardParts.Values.html#Five"><span class="hs-identifier hs-var">Five</span></a></span><span> </span><span class="annot"><span class="annottext">Suit
</span><a href="CardParts.Suits.html#Hearts"><span class="hs-identifier hs-var">Hearts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><a href="#local-6989586621679089467"><span class="hs-identifier hs-var">nextIsFantasy</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Combination]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-comment">-- getter for points for each exact line compared</span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><a href="#local-6989586621679089464"><span class="hs-identifier hs-type">getLinePoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Game.Calc.html#IntPair"><span class="hs-identifier hs-type">IntPair</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span id="local-6989586621679089464"><span class="annot"><span class="annottext">getLinePoints :: Int -&gt; Int -&gt; (Int, Int)
</span><a href="#local-6989586621679089464"><span class="hs-identifier hs-var hs-var">getLinePoints</span></a></span></span><span> </span><span id="local-6989586621679089434"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089434"><span class="hs-identifier hs-var">playerIndex</span></a></span></span><span> </span><span id="local-6989586621679089433"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089433"><span class="hs-identifier hs-var">lineIndex</span></a></span></span><span>
</span><span id="line-208"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; LineCompareResult -&gt; (Int, Int))
-&gt; (Int, Int) -&gt; [LineCompareResult] -&gt; (Int, Int)
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span>
</span><span id="line-209"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679089432"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089432"><span class="hs-identifier hs-var">comboAcc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679089431"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089431"><span class="hs-identifier hs-var">bonusAcc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679089430"><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679089430"><span class="hs-identifier hs-var">debug</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089432"><span class="hs-identifier hs-var">comboAcc</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679089430"><span class="hs-identifier hs-var">debug</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Int)] -&gt; Int -&gt; (Int, Int)
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089433"><span class="hs-identifier hs-var">lineIndex</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089431"><span class="hs-identifier hs-var">bonusAcc</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679089430"><span class="hs-identifier hs-var">debug</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Int)] -&gt; Int -&gt; (Int, Int)
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089433"><span class="hs-identifier hs-var">lineIndex</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, [LineCompareResult]) -&gt; [LineCompareResult]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, [LineCompareResult])]
</span><a href="#local-6989586621679089474"><span class="hs-identifier hs-var">linesResults</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [LineCompareResult])]
-&gt; Int -&gt; (String, [LineCompareResult])
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089434"><span class="hs-identifier hs-var">playerIndex</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">{-| Function to collect all results of line comparison between all users.

Uses recustion and accumulator to avoid redundant calculations.
For example, if &quot;user1&quot; vs &quot;user2&quot; has been already compared -
no need to compare &quot;user2&quot; vs &quot;user1&quot; - we could just mirror the existing result instead.

Function takes initial acc (empty array by default),
list of player inputs in form of '[PlayerInput]',
and the same list so it could be passed further without mutating it through recursion.

Result is list of three items - one per 'PlayerInput'.
It contains info about username and each line comparison for the user vs other users.

-}</span><span>
</span><span id="line-228"></span><span class="annot"><a href="Game.Calc.html#collectLinesResults"><span class="hs-identifier hs-type">collectLinesResults</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.Calc.html#LineCompareResult"><span class="hs-identifier hs-type">LineCompareResult</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.Calc.html#PlayerInput"><span class="hs-identifier hs-type">PlayerInput</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.Calc.html#PlayerInput"><span class="hs-identifier hs-type">PlayerInput</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.Calc.html#LineCompareResult"><span class="hs-identifier hs-type">LineCompareResult</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-229"></span><span id="collectLinesResults"><span class="annot"><span class="annottext">collectLinesResults :: [LineCompareResult]
-&gt; [PlayerInput]
-&gt; [PlayerInput]
-&gt; [(String, [LineCompareResult])]
</span><a href="Game.Calc.html#collectLinesResults"><span class="hs-identifier hs-var hs-var">collectLinesResults</span></a></span></span><span> </span><span id="local-6989586621679089429"><span class="annot"><span class="annottext">[LineCompareResult]
</span><a href="#local-6989586621679089429"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679089428"><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089428"><span class="hs-identifier hs-var">full</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679089427"><span class="annot"><span class="annottext">PlayerInput
</span><a href="#local-6989586621679089427"><span class="hs-identifier hs-var">currPlayer</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679089426"><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089426"><span class="hs-identifier hs-var">players</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlayerInput -&gt; String
</span><a href="Game.Calc.html#username"><span class="hs-identifier hs-var hs-var">username</span></a></span><span> </span><span class="annot"><span class="annottext">PlayerInput
</span><a href="#local-6989586621679089427"><span class="hs-identifier hs-var">currPlayer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(PlayerInput -&gt; LineCompareResult)
-&gt; [PlayerInput] -&gt; [LineCompareResult]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlayerInput -&gt; PlayerInput -&gt; LineCompareResult
</span><a href="#local-6989586621679089425"><span class="hs-identifier hs-var">getResult</span></a></span><span> </span><span class="annot"><span class="annottext">PlayerInput
</span><a href="#local-6989586621679089427"><span class="hs-identifier hs-var">currPlayer</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089424"><span class="hs-identifier hs-var">otherInputs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String, [LineCompareResult])
-&gt; [(String, [LineCompareResult])]
-&gt; [(String, [LineCompareResult])]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[LineCompareResult]
-&gt; [PlayerInput]
-&gt; [PlayerInput]
-&gt; [(String, [LineCompareResult])]
</span><a href="Game.Calc.html#collectLinesResults"><span class="hs-identifier hs-var">collectLinesResults</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LineCompareResult]
</span><a href="#local-6989586621679089429"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[LineCompareResult] -&gt; [LineCompareResult] -&gt; [LineCompareResult]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(PlayerInput -&gt; LineCompareResult)
-&gt; [PlayerInput] -&gt; [LineCompareResult]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlayerInput -&gt; PlayerInput -&gt; LineCompareResult
</span><a href="#local-6989586621679089425"><span class="hs-identifier hs-var">getResult</span></a></span><span> </span><span class="annot"><span class="annottext">PlayerInput
</span><a href="#local-6989586621679089427"><span class="hs-identifier hs-var">currPlayer</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089424"><span class="hs-identifier hs-var">otherInputs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089428"><span class="hs-identifier hs-var">full</span></a></span><span> </span><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089426"><span class="hs-identifier hs-var">players</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-232"></span><span>      </span><span class="hs-comment">-- Filter function to avoid self-comparison</span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><a href="#local-6989586621679089424"><span class="hs-identifier hs-type">otherInputs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.Calc.html#PlayerInput"><span class="hs-identifier hs-type">PlayerInput</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-234"></span><span>      </span><span id="local-6989586621679089424"><span class="annot"><span class="annottext">otherInputs :: [PlayerInput]
</span><a href="#local-6989586621679089424"><span class="hs-identifier hs-var hs-var">otherInputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlayerInput -&gt; Bool) -&gt; [PlayerInput] -&gt; [PlayerInput]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679089423"><span class="annot"><span class="annottext">PlayerInput
</span><a href="#local-6989586621679089423"><span class="hs-identifier hs-var">player</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PlayerInput -&gt; String
</span><a href="Game.Calc.html#username"><span class="hs-identifier hs-var hs-var">username</span></a></span><span> </span><span class="annot"><span class="annottext">PlayerInput
</span><a href="#local-6989586621679089423"><span class="hs-identifier hs-var">player</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">PlayerInput -&gt; String
</span><a href="Game.Calc.html#username"><span class="hs-identifier hs-var hs-var">username</span></a></span><span> </span><span class="annot"><span class="annottext">PlayerInput
</span><a href="#local-6989586621679089427"><span class="hs-identifier hs-var">currPlayer</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PlayerInput]
</span><a href="#local-6989586621679089428"><span class="hs-identifier hs-var">full</span></a></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span>      </span><span class="hs-comment">-- Mirroring of comparison results to be able to make (&quot;u1&quot; vs &quot;u2&quot;) into (&quot;u2&quot; vs &quot;u1&quot;)</span><span>
</span><span id="line-237"></span><span>      </span><span class="annot"><a href="#local-6989586621679089422"><span class="hs-identifier hs-type">negateTuple</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.Calc.html#IntPair"><span class="hs-identifier hs-type">IntPair</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Game.Calc.html#IntPair"><span class="hs-identifier hs-type">IntPair</span></a></span><span>
</span><span id="line-238"></span><span>      </span><span id="local-6989586621679089422"><span class="annot"><span class="annottext">negateTuple :: (Int, Int) -&gt; (Int, Int)
</span><a href="#local-6989586621679089422"><span class="hs-identifier hs-var hs-var">negateTuple</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679089421"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089421"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679089420"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089420"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089421"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089420"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span>      </span><span class="hs-comment">-- Function which tries to get existant result from the accumulator to avoid double calc</span><span>
</span><span id="line-241"></span><span>      </span><span class="annot"><a href="#local-6989586621679089425"><span class="hs-identifier hs-type">getResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.Calc.html#PlayerInput"><span class="hs-identifier hs-type">PlayerInput</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Game.Calc.html#PlayerInput"><span class="hs-identifier hs-type">PlayerInput</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.Calc.html#IntPair"><span class="hs-identifier hs-type">IntPair</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>      </span><span id="local-6989586621679089425"><span class="annot"><span class="annottext">getResult :: PlayerInput -&gt; PlayerInput -&gt; LineCompareResult
</span><a href="#local-6989586621679089425"><span class="hs-identifier hs-var hs-var">getResult</span></a></span></span><span> </span><span id="local-6989586621679089419"><span class="annot"><span class="annottext">PlayerInput
</span><a href="#local-6989586621679089419"><span class="hs-identifier hs-var">player1</span></a></span></span><span> </span><span id="local-6989586621679089418"><span class="annot"><span class="annottext">PlayerInput
</span><a href="#local-6989586621679089418"><span class="hs-identifier hs-var">player2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(LineCompareResult -&gt; Bool)
-&gt; [LineCompareResult] -&gt; Maybe LineCompareResult
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679089417"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679089417"><span class="hs-identifier hs-var">usernames</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Int, Int)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679089417"><span class="hs-identifier hs-var">usernames</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PlayerInput -&gt; String
</span><a href="Game.Calc.html#username"><span class="hs-identifier hs-var hs-var">username</span></a></span><span> </span><span class="annot"><span class="annottext">PlayerInput
</span><a href="#local-6989586621679089418"><span class="hs-identifier hs-var">player2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlayerInput -&gt; String
</span><a href="Game.Calc.html#username"><span class="hs-identifier hs-var hs-var">username</span></a></span><span> </span><span class="annot"><span class="annottext">PlayerInput
</span><a href="#local-6989586621679089419"><span class="hs-identifier hs-var">player1</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LineCompareResult]
</span><a href="#local-6989586621679089429"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-243"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679089416"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679089416"><span class="hs-identifier hs-var">usernames</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679089415"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089415"><span class="hs-identifier hs-var">combo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679089414"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089414"><span class="hs-identifier hs-var">bonus</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679089413"><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679089413"><span class="hs-identifier hs-var">debug</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; [String]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679089416"><span class="hs-identifier hs-var">usernames</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089415"><span class="hs-identifier hs-var">combo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089414"><span class="hs-identifier hs-var">bonus</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; (Int, Int)) -&gt; [(Int, Int)] -&gt; [(Int, Int)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; (Int, Int)
</span><a href="#local-6989586621679089422"><span class="hs-identifier hs-var">negateTuple</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679089413"><span class="hs-identifier hs-var">debug</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>        </span><span class="annot"><span class="annottext">Maybe LineCompareResult
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PlayerInput -&gt; PlayerInput -&gt; LineCompareResult
</span><a href="Game.Calc.html#comparePlayers"><span class="hs-identifier hs-var">comparePlayers</span></a></span><span> </span><span class="annot"><span class="annottext">PlayerInput
</span><a href="#local-6989586621679089419"><span class="hs-identifier hs-var">player1</span></a></span><span> </span><span class="annot"><span class="annottext">PlayerInput
</span><a href="#local-6989586621679089418"><span class="hs-identifier hs-var">player2</span></a></span><span>
</span><span id="line-245"></span><span class="annot"><a href="Game.Calc.html#collectLinesResults"><span class="hs-identifier hs-var">collectLinesResults</span></a></span><span> </span><span id="local-6989586621679089411"><span class="annot"><span class="annottext">[LineCompareResult]
</span><a href="#local-6989586621679089411"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="annot"><span class="annottext">[PlayerInput]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">{-| Function to compare 'PlayerInput' records and retrieve calculated points.
    Takes two 'PlayerInput' as input. Returns calculated points in form of 'LineCompareResult'
 -}</span><span>
</span><span id="line-251"></span><span class="annot"><a href="Game.Calc.html#comparePlayers"><span class="hs-identifier hs-type">comparePlayers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.Calc.html#PlayerInput"><span class="hs-identifier hs-type">PlayerInput</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Game.Calc.html#PlayerInput"><span class="hs-identifier hs-type">PlayerInput</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Game.Calc.html#LineCompareResult"><span class="hs-identifier hs-type">LineCompareResult</span></a></span><span>
</span><span id="line-252"></span><span id="comparePlayers"><span class="annot"><span class="annottext">comparePlayers :: PlayerInput -&gt; PlayerInput -&gt; LineCompareResult
</span><a href="Game.Calc.html#comparePlayers"><span class="hs-identifier hs-var hs-var">comparePlayers</span></a></span></span><span>
</span><span id="line-253"></span><span>  </span><span id="local-6989586621679089410"><span class="annot"><span class="annottext">p1 :: PlayerInput
</span><a href="#local-6989586621679089410"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Game.Calc.html#PlayerInput"><span class="hs-identifier hs-type">PlayerInput</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">username :: PlayerInput -&gt; String
</span><a href="Game.Calc.html#username"><span class="hs-identifier hs-var">username</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679089409"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679089409"><span class="hs-identifier hs-var">p1name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">board :: PlayerInput -&gt; [Combination]
</span><a href="Game.Calc.html#board"><span class="hs-identifier hs-var">board</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679089408"><span class="annot"><span class="annottext">[Combination]
</span><a href="#local-6989586621679089408"><span class="hs-identifier hs-var">boardP1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">scoop :: PlayerInput -&gt; Bool
</span><a href="Game.Calc.html#scoop"><span class="hs-identifier hs-var">scoop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679089407"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089407"><span class="hs-identifier hs-var">p1scoop</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-254"></span><span>  </span><span id="local-6989586621679089406"><span class="annot"><span class="annottext">p2 :: PlayerInput
</span><a href="#local-6989586621679089406"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Game.Calc.html#PlayerInput"><span class="hs-identifier hs-type">PlayerInput</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">username :: PlayerInput -&gt; String
</span><a href="Game.Calc.html#username"><span class="hs-identifier hs-var">username</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679089405"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679089405"><span class="hs-identifier hs-var">p2name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">board :: PlayerInput -&gt; [Combination]
</span><a href="Game.Calc.html#board"><span class="hs-identifier hs-var">board</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679089404"><span class="annot"><span class="annottext">[Combination]
</span><a href="#local-6989586621679089404"><span class="hs-identifier hs-var">boardP2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">scoop :: PlayerInput -&gt; Bool
</span><a href="Game.Calc.html#scoop"><span class="hs-identifier hs-var">scoop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679089403"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089403"><span class="hs-identifier hs-var">p2scoop</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-comment">-- List of usernames of compared players</span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679089409"><span class="hs-identifier hs-var">p1name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679089405"><span class="hs-identifier hs-var">p2name</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-comment">-- Summ of all combo points from all lines compared</span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><span class="annottext">[(Int, Int)] -&gt; Int
</span><a href="Game.Calc.html#foldPoints"><span class="hs-identifier hs-var">foldPoints</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679089401"><span class="hs-identifier hs-var">topPoints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679089400"><span class="hs-identifier hs-var">middlePoints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679089399"><span class="hs-identifier hs-var">bottomPoints</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-comment">-- Sum of all bonuses from all lines compared</span><span>
</span><span id="line-262"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089398"><span class="hs-identifier hs-var">bonusCalculated</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-comment">-- Debug info by each line</span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-special">[</span><span>
</span><span id="line-266"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int) -&gt; (Int, Int) -&gt; Int
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679089401"><span class="hs-identifier hs-var">topPoints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089396"><span class="hs-identifier hs-var">topBonus</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-267"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int) -&gt; (Int, Int) -&gt; Int
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679089400"><span class="hs-identifier hs-var">middlePoints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089395"><span class="hs-identifier hs-var">middleBonus</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-268"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int) -&gt; (Int, Int) -&gt; Int
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679089399"><span class="hs-identifier hs-var">bottomPoints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089394"><span class="hs-identifier hs-var">bottomBonus</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-comment">-- Top points getter with scoop considered</span><span>
</span><span id="line-272"></span><span>    </span><span class="annot"><a href="#local-6989586621679089401"><span class="hs-identifier hs-type">topPoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.Calc.html#IntPair"><span class="hs-identifier hs-type">IntPair</span></a></span><span>
</span><span id="line-273"></span><span>    </span><span id="local-6989586621679089401"><span class="annot"><span class="annottext">topPoints :: (Int, Int)
</span><a href="#local-6989586621679089401"><span class="hs-identifier hs-var hs-var">topPoints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-274"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089407"><span class="hs-identifier hs-var">p1scoop</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">LineType -&gt; Combination -&gt; Int
</span><a href="Game.Calc.html#getPoints"><span class="hs-identifier hs-var">getPoints</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Game.Calc.html#Top"><span class="hs-identifier hs-var">Top</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Combination] -&gt; Combination
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Combination]
</span><a href="#local-6989586621679089408"><span class="hs-identifier hs-var">boardP1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-275"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089403"><span class="hs-identifier hs-var">p2scoop</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">LineType -&gt; Combination -&gt; Int
</span><a href="Game.Calc.html#getPoints"><span class="hs-identifier hs-var">getPoints</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Game.Calc.html#Top"><span class="hs-identifier hs-var">Top</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Combination] -&gt; Combination
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Combination]
</span><a href="#local-6989586621679089404"><span class="hs-identifier hs-var">boardP2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-comment">-- Middle points getter with scoop considered</span><span>
</span><span id="line-279"></span><span>    </span><span class="annot"><a href="#local-6989586621679089400"><span class="hs-identifier hs-type">middlePoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.Calc.html#IntPair"><span class="hs-identifier hs-type">IntPair</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621679089400"><span class="annot"><span class="annottext">middlePoints :: (Int, Int)
</span><a href="#local-6989586621679089400"><span class="hs-identifier hs-var hs-var">middlePoints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-281"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089407"><span class="hs-identifier hs-var">p1scoop</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">LineType -&gt; Combination -&gt; Int
</span><a href="Game.Calc.html#getPoints"><span class="hs-identifier hs-var">getPoints</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Game.Calc.html#Middle"><span class="hs-identifier hs-var">Middle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Combination] -&gt; Combination
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([Combination] -&gt; Combination) -&gt; [Combination] -&gt; Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Combination] -&gt; [Combination]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[Combination]
</span><a href="#local-6989586621679089408"><span class="hs-identifier hs-var">boardP1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-282"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089403"><span class="hs-identifier hs-var">p2scoop</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">LineType -&gt; Combination -&gt; Int
</span><a href="Game.Calc.html#getPoints"><span class="hs-identifier hs-var">getPoints</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Game.Calc.html#Middle"><span class="hs-identifier hs-var">Middle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Combination] -&gt; Combination
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([Combination] -&gt; Combination) -&gt; [Combination] -&gt; Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Combination] -&gt; [Combination]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[Combination]
</span><a href="#local-6989586621679089404"><span class="hs-identifier hs-var">boardP2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-comment">-- Bottom points getter with scoop considered</span><span>
</span><span id="line-286"></span><span>    </span><span class="annot"><a href="#local-6989586621679089399"><span class="hs-identifier hs-type">bottomPoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.Calc.html#IntPair"><span class="hs-identifier hs-type">IntPair</span></a></span><span>
</span><span id="line-287"></span><span>    </span><span id="local-6989586621679089399"><span class="annot"><span class="annottext">bottomPoints :: (Int, Int)
</span><a href="#local-6989586621679089399"><span class="hs-identifier hs-var hs-var">bottomPoints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-288"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089407"><span class="hs-identifier hs-var">p1scoop</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">LineType -&gt; Combination -&gt; Int
</span><a href="Game.Calc.html#getPoints"><span class="hs-identifier hs-var">getPoints</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Game.Calc.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Combination] -&gt; Combination
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Combination]
</span><a href="#local-6989586621679089408"><span class="hs-identifier hs-var">boardP1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-289"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089403"><span class="hs-identifier hs-var">p2scoop</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">LineType -&gt; Combination -&gt; Int
</span><a href="Game.Calc.html#getPoints"><span class="hs-identifier hs-var">getPoints</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Game.Calc.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Combination] -&gt; Combination
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Combination]
</span><a href="#local-6989586621679089404"><span class="hs-identifier hs-var">boardP2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-comment">-- Create a tuple from number. First elem is the same number, and second one is the number mirrored</span><span>
</span><span id="line-293"></span><span>    </span><span class="annot"><a href="#local-6989586621679089389"><span class="hs-identifier hs-type">mirrorPoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Game.Calc.html#IntPair"><span class="hs-identifier hs-type">IntPair</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span id="local-6989586621679089389"><span class="annot"><span class="annottext">mirrorPoints :: Int -&gt; (Int, Int)
</span><a href="#local-6989586621679089389"><span class="hs-identifier hs-var hs-var">mirrorPoints</span></a></span></span><span> </span><span id="local-6989586621679089388"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089388"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089388"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089388"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-comment">-- Value which hold info about whether scoop occurred</span><span>
</span><span id="line-297"></span><span>    </span><span class="annot"><a href="#local-6989586621679089387"><span class="hs-identifier hs-type">anyScoop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-298"></span><span>    </span><span id="local-6989586621679089387"><span class="annot"><span class="annottext">anyScoop :: Bool
</span><a href="#local-6989586621679089387"><span class="hs-identifier hs-var hs-var">anyScoop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089407"><span class="hs-identifier hs-var">p1scoop</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089403"><span class="hs-identifier hs-var">p2scoop</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-comment">-- Bonus getter for case when no scoop occurred</span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><a href="#local-6989586621679089386"><span class="hs-identifier hs-type">getDefaultBonus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier hs-type">Combination</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier hs-type">Combination</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-302"></span><span>    </span><span id="local-6989586621679089386"><span class="annot"><span class="annottext">getDefaultBonus :: Combination -&gt; Combination -&gt; Int
</span><a href="#local-6989586621679089386"><span class="hs-identifier hs-var hs-var">getDefaultBonus</span></a></span></span><span> </span><span id="local-6989586621679089385"><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089385"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span id="local-6989586621679089384"><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089384"><span class="hs-identifier hs-var">c2</span></a></span></span><span>
</span><span id="line-303"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089385"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Combination -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089384"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-304"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089385"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Combination -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089384"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-305"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-comment">-- Bonus getter for case when scoop occurred</span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><a href="#local-6989586621679089382"><span class="hs-identifier hs-type">getScoopBonus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-309"></span><span>    </span><span id="local-6989586621679089382"><span class="annot"><span class="annottext">getScoopBonus :: Int
</span><a href="#local-6989586621679089382"><span class="hs-identifier hs-var hs-var">getScoopBonus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089407"><span class="hs-identifier hs-var">p1scoop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089403"><span class="hs-identifier hs-var">p2scoop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-310"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-311"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-312"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-313"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getDefaultBonus shouldb be used for this case&quot;</span></span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span>    </span><span class="hs-comment">-- Top line bonus calc with ability for scoop considered</span><span>
</span><span id="line-316"></span><span>    </span><span class="annot"><a href="#local-6989586621679089396"><span class="hs-identifier hs-type">topBonus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-317"></span><span>    </span><span id="local-6989586621679089396"><span class="annot"><span class="annottext">topBonus :: Int
</span><a href="#local-6989586621679089396"><span class="hs-identifier hs-var hs-var">topBonus</span></a></span></span><span>
</span><span id="line-318"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089387"><span class="hs-identifier hs-var">anyScoop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089382"><span class="hs-identifier hs-var">getScoopBonus</span></a></span><span>
</span><span id="line-319"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Combination -&gt; Int
</span><a href="#local-6989586621679089386"><span class="hs-identifier hs-var">getDefaultBonus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Combination] -&gt; Combination
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Combination]
</span><a href="#local-6989586621679089408"><span class="hs-identifier hs-var">boardP1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Combination] -&gt; Combination
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Combination]
</span><a href="#local-6989586621679089404"><span class="hs-identifier hs-var">boardP2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span>     </span><span class="hs-comment">-- Middle line bonus calc with ability for scoop considered</span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><a href="#local-6989586621679089395"><span class="hs-identifier hs-type">middleBonus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-323"></span><span>    </span><span id="local-6989586621679089395"><span class="annot"><span class="annottext">middleBonus :: Int
</span><a href="#local-6989586621679089395"><span class="hs-identifier hs-var hs-var">middleBonus</span></a></span></span><span>
</span><span id="line-324"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089387"><span class="hs-identifier hs-var">anyScoop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089382"><span class="hs-identifier hs-var">getScoopBonus</span></a></span><span>
</span><span id="line-325"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Combination -&gt; Int
</span><a href="#local-6989586621679089386"><span class="hs-identifier hs-var">getDefaultBonus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Combination] -&gt; Combination
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([Combination] -&gt; Combination) -&gt; [Combination] -&gt; Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Combination] -&gt; [Combination]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[Combination]
</span><a href="#local-6989586621679089408"><span class="hs-identifier hs-var">boardP1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Combination] -&gt; Combination
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([Combination] -&gt; Combination) -&gt; [Combination] -&gt; Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Combination] -&gt; [Combination]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[Combination]
</span><a href="#local-6989586621679089404"><span class="hs-identifier hs-var">boardP2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span>     </span><span class="hs-comment">-- Bottom line bonus calc with ability for scoop considered</span><span>
</span><span id="line-328"></span><span>    </span><span class="annot"><a href="#local-6989586621679089394"><span class="hs-identifier hs-type">bottomBonus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-329"></span><span>    </span><span id="local-6989586621679089394"><span class="annot"><span class="annottext">bottomBonus :: Int
</span><a href="#local-6989586621679089394"><span class="hs-identifier hs-var hs-var">bottomBonus</span></a></span></span><span>
</span><span id="line-330"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089387"><span class="hs-identifier hs-var">anyScoop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089382"><span class="hs-identifier hs-var">getScoopBonus</span></a></span><span>
</span><span id="line-331"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Combination -&gt; Int
</span><a href="#local-6989586621679089386"><span class="hs-identifier hs-var">getDefaultBonus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Combination] -&gt; Combination
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Combination]
</span><a href="#local-6989586621679089408"><span class="hs-identifier hs-var">boardP1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Combination] -&gt; Combination
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Combination]
</span><a href="#local-6989586621679089404"><span class="hs-identifier hs-var">boardP2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span>    </span><span class="hs-comment">-- Summ of all bonuses calculated</span><span>
</span><span id="line-334"></span><span>    </span><span class="annot"><a href="#local-6989586621679089381"><span class="hs-identifier hs-type">summBonus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-335"></span><span>    </span><span id="local-6989586621679089381"><span class="annot"><span class="annottext">summBonus :: Int
</span><a href="#local-6989586621679089381"><span class="hs-identifier hs-var hs-var">summBonus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089396"><span class="hs-identifier hs-var">topBonus</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089395"><span class="hs-identifier hs-var">middleBonus</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089394"><span class="hs-identifier hs-var">bottomBonus</span></a></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-comment">-- Extra points for all lines won calculation</span><span>
</span><span id="line-338"></span><span>    </span><span class="annot"><a href="#local-6989586621679089398"><span class="hs-identifier hs-type">bonusCalculated</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-339"></span><span>    </span><span id="local-6989586621679089398"><span class="annot"><span class="annottext">bonusCalculated :: Int
</span><a href="#local-6989586621679089398"><span class="hs-identifier hs-var hs-var">bonusCalculated</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089396"><span class="hs-identifier hs-var">topBonus</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089395"><span class="hs-identifier hs-var">middleBonus</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089394"><span class="hs-identifier hs-var">bottomBonus</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-340"></span><span>      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-341"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">3</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-342"></span><span>      </span><span id="local-6989586621679089380"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089380"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089380"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="hs-comment">-- Function to reduce all points represented as int pairs to a single number</span><span>
</span><span id="line-345"></span><span class="annot"><a href="Game.Calc.html#foldPoints"><span class="hs-identifier hs-type">foldPoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Game.Calc.html#IntPair"><span class="hs-identifier hs-type">IntPair</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-346"></span><span id="foldPoints"><span class="annot"><span class="annottext">foldPoints :: [(Int, Int)] -&gt; Int
</span><a href="Game.Calc.html#foldPoints"><span class="hs-identifier hs-var hs-var">foldPoints</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-347"></span><span class="annot"><a href="Game.Calc.html#foldPoints"><span class="hs-identifier hs-var">foldPoints</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679089379"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089379"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679089378"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089378"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679089377"><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679089377"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089379"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089378"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">[(Int, Int)] -&gt; Int
</span><a href="Game.Calc.html#foldPoints"><span class="hs-identifier hs-var">foldPoints</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679089377"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="hs-comment">-- Value which holds points data for middle line</span><span>
</span><span id="line-350"></span><span class="annot"><a href="Game.Calc.html#middlePoints"><span class="hs-identifier hs-type">middlePoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-351"></span><span id="middlePoints"><span class="annot"><span class="annottext">middlePoints :: [Int]
</span><a href="Game.Calc.html#middlePoints"><span class="hs-identifier hs-var hs-var">middlePoints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">30</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">50</span></span><span class="hs-special">]</span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-comment">-- Value which holds points data for bottom line, calculated based on 'middlePoints'</span><span>
</span><span id="line-354"></span><span class="annot"><a href="Game.Calc.html#bottomPoints"><span class="hs-identifier hs-type">bottomPoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-355"></span><span id="bottomPoints"><span class="annot"><span class="annottext">bottomPoints :: [Int]
</span><a href="Game.Calc.html#bottomPoints"><span class="hs-identifier hs-var hs-var">bottomPoints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; [Int] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679089374"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089374"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089374"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089374"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="Game.Calc.html#middlePoints"><span class="hs-identifier hs-var">middlePoints</span></a></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="hs-comment">-- Wrapper for 'getPoints' with ability of combination being 'Nothing' is case of scoop</span><span>
</span><span id="line-358"></span><span class="annot"><a href="Game.Calc.html#pointsCalc"><span class="hs-identifier hs-type">pointsCalc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.Calc.html#LineType"><span class="hs-identifier hs-type">LineType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier hs-type">Combination</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-359"></span><span id="pointsCalc"><span class="annot"><span class="annottext">pointsCalc :: LineType -&gt; Maybe Combination -&gt; Int
</span><a href="Game.Calc.html#pointsCalc"><span class="hs-identifier hs-var hs-var">pointsCalc</span></a></span></span><span> </span><span id="local-6989586621679089372"><span class="annot"><span class="annottext">LineType
</span><a href="#local-6989586621679089372"><span class="hs-identifier hs-var">lineType</span></a></span></span><span> </span><span id="local-6989586621679089371"><span class="annot"><span class="annottext">Maybe Combination
</span><a href="#local-6989586621679089371"><span class="hs-identifier hs-var">combo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Combination
</span><a href="#local-6989586621679089371"><span class="hs-identifier hs-var">combo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-360"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679089370"><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089370"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LineType -&gt; Combination -&gt; Int
</span><a href="Game.Calc.html#getPoints"><span class="hs-identifier hs-var">getPoints</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="#local-6989586621679089372"><span class="hs-identifier hs-var">lineType</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089370"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-361"></span><span>  </span><span class="annot"><span class="annottext">Maybe Combination
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-comment">-- Combination points getter</span><span>
</span><span id="line-364"></span><span class="annot"><a href="Game.Calc.html#getPoints"><span class="hs-identifier hs-type">getPoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.Calc.html#LineType"><span class="hs-identifier hs-type">LineType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier hs-type">Combination</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-365"></span><span id="getPoints"><span class="annot"><span class="annottext">getPoints :: LineType -&gt; Combination -&gt; Int
</span><a href="Game.Calc.html#getPoints"><span class="hs-identifier hs-var hs-var">getPoints</span></a></span></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Game.Calc.html#Top"><span class="hs-identifier hs-var">Top</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-type">RankCombination</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName
</span><a href="Game.Combination.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="CardParts.Cards.html#Card"><span class="hs-identifier hs-type">Card</span></a></span><span> </span><span id="local-6989586621679089369"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679089369"><span class="hs-identifier hs-var">rank</span></a></span></span><span> </span><span class="annot"><span class="annottext">Suit
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-366"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679089369"><span class="hs-identifier hs-var">rank</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679089369"><span class="hs-identifier hs-var">rank</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-367"></span><span class="annot"><a href="Game.Calc.html#getPoints"><span class="hs-identifier hs-var">getPoints</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Game.Calc.html#Top"><span class="hs-identifier hs-var">Top</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-type">RankCombination</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName
</span><a href="Game.Combination.html#Set"><span class="hs-identifier hs-var">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="CardParts.Cards.html#Card"><span class="hs-identifier hs-type">Card</span></a></span><span> </span><span id="local-6989586621679089366"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679089366"><span class="hs-identifier hs-var">rank</span></a></span></span><span> </span><span class="annot"><span class="annottext">Suit
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679089366"><span class="hs-identifier hs-var">rank</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-368"></span><span class="annot"><a href="Game.Calc.html#getPoints"><span class="hs-identifier hs-var">getPoints</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Game.Calc.html#Top"><span class="hs-identifier hs-var">Top</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-369"></span><span class="annot"><a href="Game.Calc.html#getPoints"><span class="hs-identifier hs-var">getPoints</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Game.Calc.html#Middle"><span class="hs-identifier hs-var">Middle</span></a></span><span> </span><span id="local-6989586621679089365"><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089365"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="Game.Calc.html#middlePoints"><span class="hs-identifier hs-var">middlePoints</span></a></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int -&gt; Int
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Combination -&gt; CombinationName
</span><a href="Game.Combination.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089365"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span class="annot"><a href="Game.Calc.html#getPoints"><span class="hs-identifier hs-var">getPoints</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Game.Calc.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a></span><span> </span><span id="local-6989586621679089363"><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089363"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="Game.Calc.html#bottomPoints"><span class="hs-identifier hs-var">bottomPoints</span></a></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int -&gt; Int
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Combination -&gt; CombinationName
</span><a href="Game.Combination.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089363"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span></pre></body></html>