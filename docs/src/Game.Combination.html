<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24maxtag_HJPaHfD8QwY5uNdpY3CFgQ"><span id="%24tag2con_HJPaHfD8QwY5uNdpY3CFgQ"><span id="%24con2tag_HJPaHfD8QwY5uNdpY3CFgQ"></span></span></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- | Poker combination and its processing functions</span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Game.Combination</span><span class="hs-special">(</span><span>
</span><span id="line-4"></span><span>    </span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier">Combination</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>    </span><span class="annot"><a href="Game.Combination.html#getOccurrences"><span class="hs-identifier">getOccurrences</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="Game.Combination.html#parseSequence"><span class="hs-identifier">parseSequence</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Game.Combination.html#parsePartHand"><span class="hs-identifier">parsePartHand</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Game.Combination.html#parseCombination"><span class="hs-identifier">parseCombination</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Game.Combination.html#CombinationName"><span class="hs-identifier">CombinationName</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="CardParts.Cards.html"><span class="hs-identifier">CardParts.Cards</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="CardParts.Cards.html#Card"><span class="hs-identifier">Card</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="CardParts.Values.html"><span class="hs-identifier">CardParts.Values</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="CardParts.Values.html#Value"><span class="hs-identifier">Value</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="CardParts.Suits.html"><span class="hs-identifier">CardParts.Suits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="CardParts.Suits.html#Suit"><span class="hs-identifier">Suit</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(\\)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sort</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sortBy</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FromJSON</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ToJSON</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-comment">-- | Names of combinations enum</span><span>
</span><span id="line-19"></span><span id="local-6989586621679089294"><span id="local-6989586621679089295"></span></span><span class="hs-keyword">data</span><span> </span><span id="CombinationName"><span class="annot"><a href="Game.Combination.html#CombinationName"><span class="hs-identifier hs-var">CombinationName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Kicker"><span class="annot"><a href="Game.Combination.html#Kicker"><span class="hs-identifier hs-var">Kicker</span></a></span></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Pair"><span class="annot"><a href="Game.Combination.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="TwoPairs"><span class="annot"><a href="Game.Combination.html#TwoPairs"><span class="hs-identifier hs-var">TwoPairs</span></a></span></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Set"><span class="annot"><a href="Game.Combination.html#Set"><span class="hs-identifier hs-var">Set</span></a></span></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Straight"><span class="annot"><a href="Game.Combination.html#Straight"><span class="hs-identifier hs-var">Straight</span></a></span></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Flush"><span class="annot"><a href="Game.Combination.html#Flush"><span class="hs-identifier hs-var">Flush</span></a></span></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="FullHouse"><span class="annot"><a href="Game.Combination.html#FullHouse"><span class="hs-identifier hs-var">FullHouse</span></a></span></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="FourOfAKind"><span class="annot"><a href="Game.Combination.html#FourOfAKind"><span class="hs-identifier hs-var">FourOfAKind</span></a></span></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="StraightFlush"><span class="annot"><a href="Game.Combination.html#StraightFlush"><span class="hs-identifier hs-var">StraightFlush</span></a></span></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="RoyalFlush"><span class="annot"><a href="Game.Combination.html#RoyalFlush"><span class="hs-identifier hs-var">RoyalFlush</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679089278"><span id="local-6989586621679089280"><span id="local-6989586621679089282"><span class="annot"><span class="annottext">Int -&gt; CombinationName -&gt; ShowS
[CombinationName] -&gt; ShowS
CombinationName -&gt; String
(Int -&gt; CombinationName -&gt; ShowS)
-&gt; (CombinationName -&gt; String)
-&gt; ([CombinationName] -&gt; ShowS)
-&gt; Show CombinationName
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CombinationName] -&gt; ShowS
$cshowList :: [CombinationName] -&gt; ShowS
show :: CombinationName -&gt; String
$cshow :: CombinationName -&gt; String
showsPrec :: Int -&gt; CombinationName -&gt; ShowS
$cshowsPrec :: Int -&gt; CombinationName -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679089273"><span id="local-6989586621679089275"><span class="annot"><span class="annottext">CombinationName -&gt; CombinationName -&gt; Bool
(CombinationName -&gt; CombinationName -&gt; Bool)
-&gt; (CombinationName -&gt; CombinationName -&gt; Bool)
-&gt; Eq CombinationName
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: CombinationName -&gt; CombinationName -&gt; Bool
$c/= :: CombinationName -&gt; CombinationName -&gt; Bool
== :: CombinationName -&gt; CombinationName -&gt; Bool
$c== :: CombinationName -&gt; CombinationName -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679089257"><span id="local-6989586621679089259"><span id="local-6989586621679089261"><span id="local-6989586621679089263"><span id="local-6989586621679089265"><span id="local-6989586621679089267"><span id="local-6989586621679089269"><span class="annot"><span class="annottext">Eq CombinationName
Eq CombinationName
-&gt; (CombinationName -&gt; CombinationName -&gt; Ordering)
-&gt; (CombinationName -&gt; CombinationName -&gt; Bool)
-&gt; (CombinationName -&gt; CombinationName -&gt; Bool)
-&gt; (CombinationName -&gt; CombinationName -&gt; Bool)
-&gt; (CombinationName -&gt; CombinationName -&gt; Bool)
-&gt; (CombinationName -&gt; CombinationName -&gt; CombinationName)
-&gt; (CombinationName -&gt; CombinationName -&gt; CombinationName)
-&gt; Ord CombinationName
CombinationName -&gt; CombinationName -&gt; Bool
CombinationName -&gt; CombinationName -&gt; Ordering
CombinationName -&gt; CombinationName -&gt; CombinationName
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: CombinationName -&gt; CombinationName -&gt; CombinationName
$cmin :: CombinationName -&gt; CombinationName -&gt; CombinationName
max :: CombinationName -&gt; CombinationName -&gt; CombinationName
$cmax :: CombinationName -&gt; CombinationName -&gt; CombinationName
&gt;= :: CombinationName -&gt; CombinationName -&gt; Bool
$c&gt;= :: CombinationName -&gt; CombinationName -&gt; Bool
&gt; :: CombinationName -&gt; CombinationName -&gt; Bool
$c&gt; :: CombinationName -&gt; CombinationName -&gt; Bool
&lt;= :: CombinationName -&gt; CombinationName -&gt; Bool
$c&lt;= :: CombinationName -&gt; CombinationName -&gt; Bool
&lt; :: CombinationName -&gt; CombinationName -&gt; Bool
$c&lt; :: CombinationName -&gt; CombinationName -&gt; Bool
compare :: CombinationName -&gt; CombinationName -&gt; Ordering
$ccompare :: CombinationName -&gt; CombinationName -&gt; Ordering
$cp1Ord :: Eq CombinationName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679089252"><span id="local-6989586621679089254"><span class="annot"><span class="annottext">CombinationName
CombinationName -&gt; CombinationName -&gt; Bounded CombinationName
forall a. a -&gt; a -&gt; Bounded a
maxBound :: CombinationName
$cmaxBound :: CombinationName
minBound :: CombinationName
$cminBound :: CombinationName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679089235"><span id="local-6989586621679089237"><span id="local-6989586621679089239"><span id="local-6989586621679089241"><span id="local-6989586621679089243"><span id="local-6989586621679089245"><span id="local-6989586621679089247"><span id="local-6989586621679089249"><span class="annot"><span class="annottext">Int -&gt; CombinationName
CombinationName -&gt; Int
CombinationName -&gt; [CombinationName]
CombinationName -&gt; CombinationName
CombinationName -&gt; CombinationName -&gt; [CombinationName]
CombinationName
-&gt; CombinationName -&gt; CombinationName -&gt; [CombinationName]
(CombinationName -&gt; CombinationName)
-&gt; (CombinationName -&gt; CombinationName)
-&gt; (Int -&gt; CombinationName)
-&gt; (CombinationName -&gt; Int)
-&gt; (CombinationName -&gt; [CombinationName])
-&gt; (CombinationName -&gt; CombinationName -&gt; [CombinationName])
-&gt; (CombinationName -&gt; CombinationName -&gt; [CombinationName])
-&gt; (CombinationName
    -&gt; CombinationName -&gt; CombinationName -&gt; [CombinationName])
-&gt; Enum CombinationName
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: CombinationName
-&gt; CombinationName -&gt; CombinationName -&gt; [CombinationName]
$cenumFromThenTo :: CombinationName
-&gt; CombinationName -&gt; CombinationName -&gt; [CombinationName]
enumFromTo :: CombinationName -&gt; CombinationName -&gt; [CombinationName]
$cenumFromTo :: CombinationName -&gt; CombinationName -&gt; [CombinationName]
enumFromThen :: CombinationName -&gt; CombinationName -&gt; [CombinationName]
$cenumFromThen :: CombinationName -&gt; CombinationName -&gt; [CombinationName]
enumFrom :: CombinationName -&gt; [CombinationName]
$cenumFrom :: CombinationName -&gt; [CombinationName]
fromEnum :: CombinationName -&gt; Int
$cfromEnum :: CombinationName -&gt; Int
toEnum :: Int -&gt; CombinationName
$ctoEnum :: Int -&gt; CombinationName
pred :: CombinationName -&gt; CombinationName
$cpred :: CombinationName -&gt; CombinationName
succ :: CombinationName -&gt; CombinationName
$csucc :: CombinationName -&gt; CombinationName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. CombinationName -&gt; Rep CombinationName x)
-&gt; (forall x. Rep CombinationName x -&gt; CombinationName)
-&gt; Generic CombinationName
forall x. Rep CombinationName x -&gt; CombinationName
forall x. CombinationName -&gt; Rep CombinationName x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep CombinationName x -&gt; CombinationName
$cfrom :: forall x. CombinationName -&gt; Rep CombinationName x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679089227"><span id="local-6989586621679089229"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Game.Combination.html#CombinationName"><span class="hs-identifier hs-type">CombinationName</span></a></span></span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679089218"><span id="local-6989586621679089220"><span id="local-6989586621679089222"><span id="local-6989586621679089224"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Game.Combination.html#CombinationName"><span class="hs-identifier hs-type">CombinationName</span></a></span></span></span></span></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">-- | This type represents a poker combination.</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- | It is divided by two constructors: for simple combinations (pair, set etc.)</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- | and for combinations with multiple items (two pairs, full house)</span><span>
</span><span id="line-36"></span><span id="local-6989586621679089215"><span id="local-6989586621679089216"></span></span><span class="hs-keyword">data</span><span> </span><span id="Combination"><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier hs-var">Combination</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-37"></span><span>    </span><span id="RankCombination"><span class="annot"><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-var">RankCombination</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-38"></span><span>        </span><span id="name"><span class="annot"><span class="annottext">Combination -&gt; CombinationName
</span><a href="Game.Combination.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.Combination.html#CombinationName"><span class="hs-identifier hs-type">CombinationName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>        </span><span id="rank"><span class="annot"><span class="annottext">Combination -&gt; Card
</span><a href="Game.Combination.html#rank"><span class="hs-identifier hs-var hs-var">rank</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="CardParts.Cards.html#Card"><span class="hs-identifier hs-type">Card</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="PartCombination"><span class="annot"><a href="Game.Combination.html#PartCombination"><span class="hs-identifier hs-var">PartCombination</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-41"></span><span>        </span><span id="name"><span class="annot"><a href="Game.Combination.html#name"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.Combination.html#CombinationName"><span class="hs-identifier hs-type">CombinationName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>        </span><span id="part1"><span class="annot"><span class="annottext">Combination -&gt; Card
</span><a href="Game.Combination.html#part1"><span class="hs-identifier hs-var hs-var">part1</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="CardParts.Cards.html#Card"><span class="hs-identifier hs-type">Card</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>        </span><span id="part2"><span class="annot"><span class="annottext">Combination -&gt; Card
</span><a href="Game.Combination.html#part2"><span class="hs-identifier hs-var hs-var">part2</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="CardParts.Cards.html#Card"><span class="hs-identifier hs-type">Card</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679089203"><span id="local-6989586621679089205"><span id="local-6989586621679089207"><span class="annot"><span class="annottext">Int -&gt; Combination -&gt; ShowS
[Combination] -&gt; ShowS
Combination -&gt; String
(Int -&gt; Combination -&gt; ShowS)
-&gt; (Combination -&gt; String)
-&gt; ([Combination] -&gt; ShowS)
-&gt; Show Combination
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Combination] -&gt; ShowS
$cshowList :: [Combination] -&gt; ShowS
show :: Combination -&gt; String
$cshow :: Combination -&gt; String
showsPrec :: Int -&gt; Combination -&gt; ShowS
$cshowsPrec :: Int -&gt; Combination -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. Combination -&gt; Rep Combination x)
-&gt; (forall x. Rep Combination x -&gt; Combination)
-&gt; Generic Combination
forall x. Rep Combination x -&gt; Combination
forall x. Combination -&gt; Rep Combination x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep Combination x -&gt; Combination
$cfrom :: forall x. Combination -&gt; Rep Combination x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679089197"><span id="local-6989586621679089199"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier hs-type">Combination</span></a></span></span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679089189"><span id="local-6989586621679089191"><span id="local-6989586621679089193"><span id="local-6989586621679089195"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier hs-type">Combination</span></a></span></span></span></span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">{- | Description of 'Eq' class for 'Combination'.

In case if simple `RankCombination` - equality by name and rank;
In case of complex `PartCombination` - by name, first part and second part;

__Examples:__

@
('RankCombination' 'Pair' $ 'Card' 'Three' 'Spades') == ('RankCombination' 'Pair' $ 'Card' 'Three' 'Heart') = 'True'
('RankCombination' 'Set' $ 'Card' 'Three' 'Spades') == ('RankCombination' 'Pair' $ 'Card' 'Three' 'Heart') = 'False'
('RankCombination' 'Set' $ 'Card' 'Three' 'Spades') == ('RankCombination' 'Straight' $ 'Card' 'Three' 'Heart') = 'False'
@
-}</span><span>
</span><span id="line-62"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679089186"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier hs-type">Combination</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621679089185"><span class="annot"><span class="annottext">c1 :: Combination
</span><a href="#local-6989586621679089185"><span class="hs-identifier hs-var">c1</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-type">RankCombination</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span id="local-6989586621679089184"><span class="annot"><span class="annottext">== :: Combination -&gt; Combination -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span id="local-6989586621679089183"><span class="annot"><span class="annottext">c2 :: Combination
</span><a href="#local-6989586621679089183"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-type">RankCombination</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-64"></span><span>        </span><span class="annot"><span class="annottext">Combination -&gt; CombinationName
</span><a href="Game.Combination.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089185"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; CombinationName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; CombinationName
</span><a href="Game.Combination.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089183"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Card
</span><a href="Game.Combination.html#rank"><span class="hs-identifier hs-var hs-var">rank</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089185"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Card -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Card
</span><a href="Game.Combination.html#rank"><span class="hs-identifier hs-var hs-var">rank</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089183"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span id="local-6989586621679089181"><span class="annot"><span class="annottext">c1 :: Combination
</span><a href="#local-6989586621679089181"><span class="hs-identifier hs-var">c1</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Game.Combination.html#PartCombination"><span class="hs-identifier hs-type">PartCombination</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span id="local-6989586621679089180"><span class="annot"><span class="annottext">c2 :: Combination
</span><a href="#local-6989586621679089180"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Game.Combination.html#PartCombination"><span class="hs-identifier hs-type">PartCombination</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-66"></span><span>        </span><span class="annot"><span class="annottext">Combination -&gt; CombinationName
</span><a href="Game.Combination.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089181"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; CombinationName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; CombinationName
</span><a href="Game.Combination.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089180"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Card
</span><a href="Game.Combination.html#part1"><span class="hs-identifier hs-var hs-var">part1</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089181"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Card -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Card
</span><a href="Game.Combination.html#part1"><span class="hs-identifier hs-var hs-var">part1</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089180"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Card
</span><a href="Game.Combination.html#part2"><span class="hs-identifier hs-var hs-var">part2</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089181"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Card -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Card
</span><a href="Game.Combination.html#part2"><span class="hs-identifier hs-var hs-var">part2</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089180"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span id="local-6989586621679089179"><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089179"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span id="local-6989586621679089178"><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089178"><span class="hs-identifier hs-var">c2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; CombinationName
</span><a href="Game.Combination.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089179"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; CombinationName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; CombinationName
</span><a href="Game.Combination.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089178"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">{- | Description of 'Ord' class for 'Combination'.

In case if simple `RankCombination` - compare by name and rank;
In case of complex `PartCombination` - by name, first part and second part;

__Examples:__

@
('RankCombination' 'Pair' $ 'Card' 'Three' 'Spades') `compare` ('RankCombination' 'Pair' $ 'Card' 'Three' 'Heart') = 'EQ'
('RankCombination' 'Set' $ 'Card' 'Three' 'Spades') `compare` ('RankCombination' 'Pair' $ 'Card' 'Three' 'Heart') = 'GT'
('RankCombination' 'Set' $ 'Card' 'Three' 'Spades') `compare` ('RankCombination' 'Straight' $ 'Card' 'Three' 'Heart') = 'LT'
@
-}</span><span>
</span><span id="line-82"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679089164"><span id="local-6989586621679089166"><span id="local-6989586621679089168"><span id="local-6989586621679089170"><span id="local-6989586621679089172"><span id="local-6989586621679089174"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier hs-type">Combination</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-83"></span><span>    </span><span id="local-6989586621679089163"><span class="annot"><span class="annottext">c1 :: Combination
</span><a href="#local-6989586621679089163"><span class="hs-identifier hs-var">c1</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-type">RankCombination</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span id="local-6989586621679089162"><span class="annot"><span class="annottext">compare :: Combination -&gt; Combination -&gt; Ordering
</span><span class="hs-operator hs-var hs-var hs-var hs-var">`compare`</span></span></span><span> </span><span id="local-6989586621679089160"><span class="annot"><span class="annottext">c2 :: Combination
</span><a href="#local-6989586621679089160"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-type">RankCombination</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-84"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; CombinationName
</span><a href="Game.Combination.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089163"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; CombinationName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; CombinationName
</span><a href="Game.Combination.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089160"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Card
</span><a href="Game.Combination.html#rank"><span class="hs-identifier hs-var hs-var">rank</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089163"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Card -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Card
</span><a href="Game.Combination.html#rank"><span class="hs-identifier hs-var hs-var">rank</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089160"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-85"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; CombinationName
</span><a href="Game.Combination.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089163"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; CombinationName -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; CombinationName
</span><a href="Game.Combination.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089160"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span id="local-6989586621679089159"><span class="annot"><span class="annottext">c1 :: Combination
</span><a href="#local-6989586621679089159"><span class="hs-identifier hs-var">c1</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Game.Combination.html#PartCombination"><span class="hs-identifier hs-type">PartCombination</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="annot"><span class="hs-operator hs-var">`compare`</span></span><span> </span><span id="local-6989586621679089158"><span class="annot"><span class="annottext">c2 :: Combination
</span><a href="#local-6989586621679089158"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Game.Combination.html#PartCombination"><span class="hs-identifier hs-type">PartCombination</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-87"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; CombinationName
</span><a href="Game.Combination.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089159"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; CombinationName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; CombinationName
</span><a href="Game.Combination.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089158"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; CombinationName
</span><a href="Game.Combination.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089159"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; CombinationName -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; CombinationName
</span><a href="Game.Combination.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089158"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-88"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Card
</span><a href="Game.Combination.html#part1"><span class="hs-identifier hs-var hs-var">part1</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089159"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Card -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Card
</span><a href="Game.Combination.html#part1"><span class="hs-identifier hs-var hs-var">part1</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089158"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Card
</span><a href="Game.Combination.html#part2"><span class="hs-identifier hs-var hs-var">part2</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089159"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Card -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Card
</span><a href="Game.Combination.html#part2"><span class="hs-identifier hs-var hs-var">part2</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089158"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-89"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Card
</span><a href="Game.Combination.html#part1"><span class="hs-identifier hs-var hs-var">part1</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089159"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Card -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Card
</span><a href="Game.Combination.html#part1"><span class="hs-identifier hs-var hs-var">part1</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089158"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span id="local-6989586621679089156"><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089156"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">`compare`</span></span><span> </span><span id="local-6989586621679089155"><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089155"><span class="hs-identifier hs-var">c2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; CombinationName
</span><a href="Game.Combination.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089156"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; CombinationName -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">Combination -&gt; CombinationName
</span><a href="Game.Combination.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Combination
</span><a href="#local-6989586621679089155"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="annot"><a href="Game.Combination.html#parseCombination"><span class="hs-identifier hs-type">parseCombination</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="CardParts.Cards.html#Card"><span class="hs-identifier hs-type">Card</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier hs-type">Combination</span></a></span><span>
</span><span id="line-94"></span><span id="parseCombination"><span class="annot"><span class="annottext">parseCombination :: [Card] -&gt; Either String Combination
</span><a href="Game.Combination.html#parseCombination"><span class="hs-identifier hs-var hs-var">parseCombination</span></a></span></span><span> </span><span id="local-6989586621679089154"><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089154"><span class="hs-identifier hs-var">cards</span></a></span></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Card] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089154"><span class="hs-identifier hs-var">cards</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[Card] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089154"><span class="hs-identifier hs-var">cards</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Combination
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String Combination)
-&gt; String -&gt; Either String Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid line length: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Card] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089154"><span class="hs-identifier hs-var">cards</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[(Card, Int)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(Card, Int)]
</span><a href="#local-6989586621679089150"><span class="hs-identifier hs-var">pairs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Card] -&gt; Either String Combination
</span><a href="Game.Combination.html#parseSequence"><span class="hs-identifier hs-var">parseSequence</span></a></span><span> </span><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089154"><span class="hs-identifier hs-var">cards</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Card, Int)] -&gt; Either String Combination
</span><a href="Game.Combination.html#parsePartHand"><span class="hs-identifier hs-var">parsePartHand</span></a></span><span> </span><span class="annot"><span class="annottext">[(Card, Int)]
</span><a href="#local-6989586621679089150"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-98"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-99"></span><span>            </span><span id="local-6989586621679089150"><span class="annot"><span class="annottext">pairs :: [(Card, Int)]
</span><a href="#local-6989586621679089150"><span class="hs-identifier hs-var hs-var">pairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Card, Int)
</span><a href="#local-6989586621679089149"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679089149"><span class="annot"><span class="annottext">occ :: (Card, Int)
</span><a href="#local-6989586621679089149"><span class="hs-identifier hs-var">occ</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679089148"><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679089148"><span class="hs-identifier hs-var">card</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679089147"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089147"><span class="hs-identifier hs-var">count</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Card] -&gt; [(Card, Int)]
</span><a href="Game.Combination.html#getOccurrences"><span class="hs-identifier hs-var">getOccurrences</span></a></span><span> </span><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089154"><span class="hs-identifier hs-var">cards</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089147"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- | Type shorthand for occurrences counter wrapper</span><span>
</span><span id="line-103"></span><span class="hs-keyword">type</span><span> </span><span id="OccurrencesCounter"><span class="annot"><a href="Game.Combination.html#OccurrencesCounter"><span class="hs-identifier hs-var">OccurrencesCounter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="CardParts.Cards.html#Card"><span class="hs-identifier hs-type">Card</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">{- | This function gets a list of cards and returns a list of tuples.
First element of which contains certain card, and second element contains number of occurences.

Function takes the head of the list and search for occurrences of its card in the tail.
Then, recursively calls itself for tail with that card removed from it.

__Examples:__

@
getOccurrences [
    'Card' {value = 'Ace', suit = 'Spades'},
    'Card' {value = 'Jack', suit = 'Clubs'},
    'Card' {value = 'Ace', suit = 'Hearts}
] = [(Card {value = Ace, suit = Spades},2),(Card {value = Jack, suit = Clubs},1)]
@
-}</span><span>
</span><span id="line-121"></span><span class="annot"><a href="Game.Combination.html#getOccurrences"><span class="hs-identifier hs-type">getOccurrences</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="CardParts.Cards.html#Card"><span class="hs-identifier hs-type">Card</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Game.Combination.html#OccurrencesCounter"><span class="hs-identifier hs-type">OccurrencesCounter</span></a></span><span>
</span><span id="line-122"></span><span id="getOccurrences"><span class="annot"><span class="annottext">getOccurrences :: [Card] -&gt; [(Card, Int)]
</span><a href="Game.Combination.html#getOccurrences"><span class="hs-identifier hs-var hs-var">getOccurrences</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-123"></span><span class="annot"><a href="Game.Combination.html#getOccurrences"><span class="hs-identifier hs-var">getOccurrences</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679089144"><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679089144"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679089143"><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089143"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679089144"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Card] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089142"><span class="hs-identifier hs-var">xSameValue</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Card, Int) -&gt; [(Card, Int)] -&gt; [(Card, Int)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Card] -&gt; [(Card, Int)]
</span><a href="Game.Combination.html#getOccurrences"><span class="hs-identifier hs-var">getOccurrences</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089143"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[Card] -&gt; [Card] -&gt; [Card]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089142"><span class="hs-identifier hs-var">xSameValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>        </span><span id="local-6989586621679089142"><span class="annot"><span class="annottext">xSameValue :: [Card]
</span><a href="#local-6989586621679089142"><span class="hs-identifier hs-var hs-var">xSameValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Card -&gt; Bool) -&gt; [Card] -&gt; [Card]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679089140"><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679089140"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Card -&gt; Value
</span><a href="CardParts.Cards.html#value"><span class="hs-identifier hs-var hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679089144"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Value
</span><a href="CardParts.Cards.html#value"><span class="hs-identifier hs-var hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679089140"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089143"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">{- | This function parses occurences data and returns a combination, wrapped with 'Right',
or string err msg wrapped with 'Left'.
The input is list of tuples - [('Card', 'Int')], where first element is a card and seconds is number of its occurrences.
__Examples:__

@
parsePartHand [
     'Card' {value = 'Ace', suit = 'Spades'},
    'Card' {value = 'Jack', suit = 'Clubs'},
    'Card' {value = 'Ten', suit = 'Clubs'},
    'Card' {value = 'Queen', suit = 'Hearts},
    'Card' {value = 'King', suit = 'Hearts},
] = 'Right' 'RankCombination' 'Straight' 'Card' {value = 'Ace', suit = 'Spades'}
@
-}</span><span>
</span><span id="line-142"></span><span class="annot"><a href="Game.Combination.html#parsePartHand"><span class="hs-identifier hs-type">parsePartHand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.Combination.html#OccurrencesCounter"><span class="hs-identifier hs-type">OccurrencesCounter</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier hs-type">Combination</span></a></span><span>
</span><span id="line-143"></span><span id="parsePartHand"><span class="annot"><span class="annottext">parsePartHand :: [(Card, Int)] -&gt; Either String Combination
</span><a href="Game.Combination.html#parsePartHand"><span class="hs-identifier hs-var hs-var">parsePartHand</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Combination
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Can't process empty pairs array&quot;</span></span><span>
</span><span id="line-144"></span><span class="annot"><a href="Game.Combination.html#parsePartHand"><span class="hs-identifier hs-var">parsePartHand</span></a></span><span> </span><span id="local-6989586621679089138"><span class="annot"><span class="annottext">pairs :: [(Card, Int)]
</span><a href="#local-6989586621679089138"><span class="hs-identifier hs-var">pairs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679089137"><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679089137"><span class="hs-identifier hs-var">yCard</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679089136"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089136"><span class="hs-identifier hs-var">yCount</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679089135"><span class="annot"><span class="annottext">[(Card, Int)]
</span><a href="#local-6989586621679089135"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Card, Int)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(Card, Int)]
</span><a href="#local-6989586621679089138"><span class="hs-identifier hs-var">pairs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either String Combination
</span><a href="#local-6989586621679089134"><span class="hs-identifier hs-var">singlePairHand</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either String Combination
</span><a href="#local-6989586621679089133"><span class="hs-identifier hs-var">multiplePairsHand</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span id="local-6989586621679089132"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089132"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Combination
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String Combination)
-&gt; String -&gt; Either String Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid number of pairs: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089132"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-comment">-- | In case if only one pair found (pair, set or four of a kind)</span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><a href="#local-6989586621679089134"><span class="hs-identifier hs-type">singlePairHand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier hs-type">Combination</span></a></span><span>
</span><span id="line-151"></span><span>        </span><span id="local-6989586621679089134"><span class="annot"><span class="annottext">singlePairHand :: Either String Combination
</span><a href="#local-6989586621679089134"><span class="hs-identifier hs-var hs-var">singlePairHand</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089136"><span class="hs-identifier hs-var">yCount</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-152"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Either String Combination
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Combination -&gt; Either String Combination)
-&gt; Combination -&gt; Either String Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; Card -&gt; Combination
</span><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-var">RankCombination</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName
</span><a href="Game.Combination.html#FourOfAKind"><span class="hs-identifier hs-var">FourOfAKind</span></a></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679089137"><span class="hs-identifier hs-var">yCard</span></a></span><span>
</span><span id="line-153"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Either String Combination
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Combination -&gt; Either String Combination)
-&gt; Combination -&gt; Either String Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; Card -&gt; Combination
</span><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-var">RankCombination</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName
</span><a href="Game.Combination.html#Set"><span class="hs-identifier hs-var">Set</span></a></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679089137"><span class="hs-identifier hs-var">yCard</span></a></span><span>
</span><span id="line-154"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Either String Combination
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Combination -&gt; Either String Combination)
-&gt; Combination -&gt; Either String Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; Card -&gt; Combination
</span><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-var">RankCombination</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName
</span><a href="Game.Combination.html#Pair"><span class="hs-identifier hs-var">Pair</span></a></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679089137"><span class="hs-identifier hs-var">yCard</span></a></span><span>
</span><span id="line-155"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Combination
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String Combination)
-&gt; String -&gt; Either String Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Single pair hand: found invalid number of pairs: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089136"><span class="hs-identifier hs-var">yCount</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span>        </span><span class="hs-comment">-- | In case if multiple pairs found (two pairs or full house)</span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><a href="#local-6989586621679089133"><span class="hs-identifier hs-type">multiplePairsHand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier hs-type">Combination</span></a></span><span>
</span><span id="line-159"></span><span>        </span><span id="local-6989586621679089133"><span class="annot"><span class="annottext">multiplePairsHand :: Either String Combination
</span><a href="#local-6989586621679089133"><span class="hs-identifier hs-var hs-var">multiplePairsHand</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089131"><span class="hs-identifier hs-var">multiplePairsSum</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-160"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Either String Combination
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Combination -&gt; Either String Combination)
-&gt; Combination -&gt; Either String Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; Card -&gt; Card -&gt; Combination
</span><a href="Game.Combination.html#PartCombination"><span class="hs-identifier hs-var">PartCombination</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName
</span><a href="Game.Combination.html#TwoPairs"><span class="hs-identifier hs-var">TwoPairs</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Card] -&gt; Card
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">([Card] -&gt; Card) -&gt; [Card] -&gt; Card
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Card, Int) -&gt; Card) -&gt; [(Card, Int)] -&gt; [Card]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Card, Int) -&gt; Card
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(Card, Int)]
</span><a href="#local-6989586621679089138"><span class="hs-identifier hs-var">pairs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Card] -&gt; Card
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">minimum</span></span><span> </span><span class="annot"><span class="annottext">([Card] -&gt; Card) -&gt; [Card] -&gt; Card
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Card, Int) -&gt; Card) -&gt; [(Card, Int)] -&gt; [Card]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Card, Int) -&gt; Card
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(Card, Int)]
</span><a href="#local-6989586621679089138"><span class="hs-identifier hs-var">pairs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Either String Combination
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Combination -&gt; Either String Combination)
-&gt; Combination -&gt; Either String Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; Card -&gt; Card -&gt; Combination
</span><a href="Game.Combination.html#PartCombination"><span class="hs-identifier hs-var">PartCombination</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName
</span><a href="Game.Combination.html#FullHouse"><span class="hs-identifier hs-var">FullHouse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Card, Int) -&gt; Card
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Card, Int) -&gt; Card)
-&gt; ([(Card, Int)] -&gt; (Card, Int)) -&gt; [(Card, Int)] -&gt; Card
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Card, Int)] -&gt; (Card, Int)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([(Card, Int)] -&gt; Card) -&gt; [(Card, Int)] -&gt; Card
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Card, Int)]
</span><a href="#local-6989586621679089126"><span class="hs-identifier hs-var">sortedPairsByCount</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Card, Int) -&gt; Card
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Card, Int) -&gt; Card)
-&gt; ([(Card, Int)] -&gt; (Card, Int)) -&gt; [(Card, Int)] -&gt; Card
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Card, Int)] -&gt; (Card, Int)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">([(Card, Int)] -&gt; Card) -&gt; [(Card, Int)] -&gt; Card
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Card, Int)]
</span><a href="#local-6989586621679089126"><span class="hs-identifier hs-var">sortedPairsByCount</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Combination
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String Combination)
-&gt; String -&gt; Either String Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid multiple pairs sum: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089131"><span class="hs-identifier hs-var">multiplePairsSum</span></a></span><span>
</span><span id="line-163"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>                </span><span class="hs-comment">-- | Sum counters to find out if it fits the valid combinations</span><span>
</span><span id="line-165"></span><span>                </span><span class="annot"><a href="#local-6989586621679089131"><span class="hs-identifier hs-type">multiplePairsSum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-166"></span><span>                </span><span id="local-6989586621679089131"><span class="annot"><span class="annottext">multiplePairsSum :: Int
</span><a href="#local-6989586621679089131"><span class="hs-identifier hs-var hs-var">multiplePairsSum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int) -&gt; [Int] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Card, Int) -&gt; Int) -&gt; [(Card, Int)] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Card, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(Card, Int)]
</span><a href="#local-6989586621679089138"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span>                </span><span class="hs-comment">-- | Sort pairs to be able to get higher lower for combinations, where it matters</span><span>
</span><span id="line-169"></span><span>                </span><span class="annot"><a href="#local-6989586621679089126"><span class="hs-identifier hs-type">sortedPairsByCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Game.Combination.html#OccurrencesCounter"><span class="hs-identifier hs-type">OccurrencesCounter</span></a></span><span>
</span><span id="line-170"></span><span>                </span><span id="local-6989586621679089126"><span class="annot"><span class="annottext">sortedPairsByCount :: [(Card, Int)]
</span><a href="#local-6989586621679089126"><span class="hs-identifier hs-var hs-var">sortedPairsByCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Card, Int) -&gt; (Card, Int) -&gt; Ordering)
-&gt; [(Card, Int)] -&gt; [(Card, Int)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Card
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679089123"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089123"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Card
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679089122"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089122"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089122"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089123"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Card, Int)]
</span><a href="#local-6989586621679089138"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-comment">{- | This function parses sequences in cards line returns a combination, wrapped with 'Right',
or string err msg wrapped with 'Left'.
The input is list of cards - ['Card'].
__Examples:__

@
parseSequence [
    ('Card' {value = 'Ace', suit = 'Spades'}, 2),
    ('Card' {value = 'King', suit = 'Clubs'}, 2)
] = 'Right' 'PartCombination' 'TwoPairs' ('Card' {value = 'Ace', suit = 'Spades') ('Card' {value = 'King', suit = 'Clubs'})
@
-}</span><span>
</span><span id="line-184"></span><span class="annot"><a href="Game.Combination.html#parseSequence"><span class="hs-identifier hs-type">parseSequence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="CardParts.Cards.html#Card"><span class="hs-identifier hs-type">Card</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Game.Combination.html#Combination"><span class="hs-identifier hs-type">Combination</span></a></span><span>
</span><span id="line-185"></span><span id="parseSequence"><span class="annot"><span class="annottext">parseSequence :: [Card] -&gt; Either String Combination
</span><a href="Game.Combination.html#parseSequence"><span class="hs-identifier hs-var hs-var">parseSequence</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Combination
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Can't process empty list&quot;</span></span><span>
</span><span id="line-186"></span><span class="annot"><a href="Game.Combination.html#parseSequence"><span class="hs-identifier hs-var">parseSequence</span></a></span><span> </span><span id="local-6989586621679089121"><span class="annot"><span class="annottext">cards :: [Card]
</span><a href="#local-6989586621679089121"><span class="hs-identifier hs-var">cards</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679089120"><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679089120"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679089119"><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089119"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089118"><span class="hs-identifier hs-var">isFlush</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089117"><span class="hs-identifier hs-var">isSequence</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089116"><span class="hs-identifier hs-var">isWheel</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Either String Combination
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Combination -&gt; Either String Combination)
-&gt; Combination -&gt; Either String Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; Card -&gt; Combination
</span><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-var">RankCombination</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName
</span><a href="Game.Combination.html#Straight"><span class="hs-identifier hs-var">Straight</span></a></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679089115"><span class="hs-identifier hs-var">maxCard</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Either String Combination
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Combination -&gt; Either String Combination)
-&gt; Combination -&gt; Either String Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; Card -&gt; Combination
</span><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-var">RankCombination</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName
</span><a href="Game.Combination.html#Straight"><span class="hs-identifier hs-var">Straight</span></a></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679089115"><span class="hs-identifier hs-var">maxCard</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Either String Combination
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Combination -&gt; Either String Combination)
-&gt; Combination -&gt; Either String Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; Card -&gt; Combination
</span><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-var">RankCombination</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName
</span><a href="Game.Combination.html#Flush"><span class="hs-identifier hs-var">Flush</span></a></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679089115"><span class="hs-identifier hs-var">maxCard</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Card -&gt; Value
</span><a href="CardParts.Cards.html#value"><span class="hs-identifier hs-var hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679089115"><span class="hs-identifier hs-var">maxCard</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-191"></span><span>        </span><span class="annot"><span class="annottext">Value
</span><a href="CardParts.Values.html#Ace"><span class="hs-identifier hs-var">Ace</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Either String Combination
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Combination -&gt; Either String Combination)
-&gt; Combination -&gt; Either String Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; Card -&gt; Combination
</span><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-var">RankCombination</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName
</span><a href="Game.Combination.html#RoyalFlush"><span class="hs-identifier hs-var">RoyalFlush</span></a></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679089115"><span class="hs-identifier hs-var">maxCard</span></a></span><span>
</span><span id="line-192"></span><span>        </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Either String Combination
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Combination -&gt; Either String Combination)
-&gt; Combination -&gt; Either String Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; Card -&gt; Combination
</span><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-var">RankCombination</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName
</span><a href="Game.Combination.html#StraightFlush"><span class="hs-identifier hs-var">StraightFlush</span></a></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679089115"><span class="hs-identifier hs-var">maxCard</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Either String Combination
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Combination -&gt; Either String Combination)
-&gt; Combination -&gt; Either String Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; Card -&gt; Combination
</span><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-var">RankCombination</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName
</span><a href="Game.Combination.html#StraightFlush"><span class="hs-identifier hs-var">StraightFlush</span></a></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679089115"><span class="hs-identifier hs-var">maxCard</span></a></span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Combination -&gt; Either String Combination
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Combination -&gt; Either String Combination)
-&gt; Combination -&gt; Either String Combination
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CombinationName -&gt; Card -&gt; Combination
</span><a href="Game.Combination.html#RankCombination"><span class="hs-identifier hs-var">RankCombination</span></a></span><span> </span><span class="annot"><span class="annottext">CombinationName
</span><a href="Game.Combination.html#Kicker"><span class="hs-identifier hs-var">Kicker</span></a></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679089115"><span class="hs-identifier hs-var">maxCard</span></a></span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><span class="annottext">(Bool, Bool, Bool)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Combination
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Can't parse the combination&quot;</span></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-197"></span><span>        </span><span class="hs-comment">-- | Simply sort cards</span><span>
</span><span id="line-198"></span><span>        </span><span class="annot"><a href="#local-6989586621679089113"><span class="hs-identifier hs-type">sortedCards</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="CardParts.Cards.html#Card"><span class="hs-identifier hs-type">Card</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-199"></span><span>        </span><span id="local-6989586621679089113"><span class="annot"><span class="annottext">sortedCards :: [Card]
</span><a href="#local-6989586621679089113"><span class="hs-identifier hs-var hs-var">sortedCards</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Card] -&gt; [Card]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089121"><span class="hs-identifier hs-var">cards</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span>        </span><span class="hs-comment">-- | Check if the line is a wheel (special variant of straight - A2345)</span><span>
</span><span id="line-202"></span><span>        </span><span class="annot"><a href="#local-6989586621679089116"><span class="hs-identifier hs-type">isWheel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-203"></span><span>        </span><span id="local-6989586621679089116"><span class="annot"><span class="annottext">isWheel :: Bool
</span><a href="#local-6989586621679089116"><span class="hs-identifier hs-var hs-var">isWheel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Card -&gt; Value) -&gt; [Card] -&gt; [Value]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Value
</span><a href="CardParts.Cards.html#value"><span class="hs-identifier hs-var hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089113"><span class="hs-identifier hs-var">sortedCards</span></a></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; [Value] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Value
</span><a href="CardParts.Values.html#Two"><span class="hs-identifier hs-var">Two</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="CardParts.Values.html#Three"><span class="hs-identifier hs-var">Three</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="CardParts.Values.html#Four"><span class="hs-identifier hs-var">Four</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="CardParts.Values.html#Five"><span class="hs-identifier hs-var">Five</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="CardParts.Values.html#Ace"><span class="hs-identifier hs-var">Ace</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>        </span><span class="hs-comment">-- Check if the line is a flush (all suits are the same)</span><span>
</span><span id="line-206"></span><span>        </span><span class="annot"><a href="#local-6989586621679089118"><span class="hs-identifier hs-type">isFlush</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-207"></span><span>        </span><span id="local-6989586621679089118"><span class="annot"><span class="annottext">isFlush :: Bool
</span><a href="#local-6989586621679089118"><span class="hs-identifier hs-var hs-var">isFlush</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Card] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089121"><span class="hs-identifier hs-var">cards</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-208"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Card -&gt; Bool) -&gt; [Card] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Suit -&gt; Suit -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Suit
</span><a href="CardParts.Cards.html#suit"><span class="hs-identifier hs-var hs-var">suit</span></a></span><span> </span><span class="annot"><span class="annottext">Card
</span><a href="#local-6989586621679089120"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Suit -&gt; Bool) -&gt; (Card -&gt; Suit) -&gt; Card -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Suit
</span><a href="CardParts.Cards.html#suit"><span class="hs-identifier hs-var hs-var">suit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089119"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span>        </span><span class="hs-comment">-- | Helper function for sequence checking</span><span>
</span><span id="line-211"></span><span>        </span><span class="annot"><a href="#local-6989586621679089106"><span class="hs-identifier hs-type">getValueNum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-212"></span><span>        </span><span id="local-6989586621679089106"><span class="annot"><span class="annottext">getValueNum :: Int -&gt; Int
</span><a href="#local-6989586621679089106"><span class="hs-identifier hs-var hs-var">getValueNum</span></a></span></span><span> </span><span id="local-6989586621679089105"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089105"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Int) -&gt; (Card -&gt; Value) -&gt; Card -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Card -&gt; Value
</span><a href="CardParts.Cards.html#value"><span class="hs-identifier hs-var hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">(Card -&gt; Int) -&gt; Card -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089113"><span class="hs-identifier hs-var">sortedCards</span></a></span><span> </span><span class="annot"><span class="annottext">[Card] -&gt; Int -&gt; Card
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089105"><span class="hs-identifier hs-var">index</span></a></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span>        </span><span class="hs-comment">-- | Check whether sorted elements form a sequence</span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><a href="#local-6989586621679089117"><span class="hs-identifier hs-type">isSequence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-216"></span><span>        </span><span id="local-6989586621679089117"><span class="annot"><span class="annottext">isSequence :: Bool
</span><a href="#local-6989586621679089117"><span class="hs-identifier hs-var hs-var">isSequence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Card] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089121"><span class="hs-identifier hs-var">cards</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-217"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; [Int] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679089106"><span class="hs-identifier hs-var">getValueNum</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089102"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679089106"><span class="hs-identifier hs-var">getValueNum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089102"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679089102"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679089102"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">[Card] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089113"><span class="hs-identifier hs-var">sortedCards</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>        </span><span class="hs-comment">-- | Get max card for the cards line</span><span>
</span><span id="line-220"></span><span>        </span><span class="annot"><a href="#local-6989586621679089115"><span class="hs-identifier hs-type">maxCard</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="CardParts.Cards.html#Card"><span class="hs-identifier hs-type">Card</span></a></span><span>
</span><span id="line-221"></span><span>        </span><span id="local-6989586621679089115"><span class="annot"><span class="annottext">maxCard :: Card
</span><a href="#local-6989586621679089115"><span class="hs-identifier hs-var hs-var">maxCard</span></a></span></span><span>
</span><span id="line-222"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679089116"><span class="hs-identifier hs-var">isWheel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Card] -&gt; Card
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">([Card] -&gt; Card) -&gt; [Card] -&gt; Card
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Card] -&gt; [Card]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">init</span></span><span> </span><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089113"><span class="hs-identifier hs-var">sortedCards</span></a></span><span>
</span><span id="line-223"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Card] -&gt; Card
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">[Card]
</span><a href="#local-6989586621679089121"><span class="hs-identifier hs-var">cards</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span></pre></body></html>